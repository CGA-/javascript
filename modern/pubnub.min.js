// 3.4.2
(function(){
var k=!0,l=null,m=!1;function p(){return function(){}}function x(a){return function(){return a}}var C=1,D=m,F=[],G="-pnpres",H=10,I=310,M=60,N=1E3,aa=/{([\w\-]+)}/g;function ba(){return"x"+ ++C+""+ +new Date}function P(){return+new Date}var Q,ca=Math.floor(20*Math.random());Q=function(a,b){return 0<a.indexOf("pubsub.")&&a.replace("pubsub","ps"+(b?R().split("-")[0]:20>++ca?ca:ca=1))||a};function da(a,b){function c(){f+b>P()?(clearTimeout(d),d=setTimeout(c,b)):(f=P(),a())}var d,f=0;return c}
function ea(a,b){var c=[];W(a||[],function(a){b(a)&&c.push(a)});return c}function fa(a,b){return a.replace(aa,function(a,d){return b[d]||a})}function X(a,b){return setTimeout(a,b)}function R(a){var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});a&&a(b);return b}
function W(a,b){if(a&&b)if("undefined"!=typeof a[0])for(var c=0,d=a.length;c<d;)b.call(a[c],a[c],c++);else for(c in a)a.hasOwnProperty&&a.hasOwnProperty(c)&&b.call(a[c],c,a[c])}function Y(a,b){var c=[];W(a||[],function(a,f){c.push(b(a,f))});return c}function Z(a){return Y(encodeURIComponent(a).split(""),function(a){return 0>"-_.!~*'()".indexOf(a)?a:"%"+a.charCodeAt(0).toString(16).toUpperCase()}).join("")}function $(a){var b=[];W(a,function(a,d){d.f&&b.push(a)});return b.sort()}
function ga(){X(function(){D||(D=1,W(F,function(a){a()}))},N)}
function ja(a){function b(){}function c(a){a&&(s.g=0);!s.g&&s.length&&(s.g=1,t(s.shift()))}function d(a){W($(j),function(b){(b=j[b])&&a(b)})}var f=+a.windowing||H,n=(+a.timeout||I)*N,u=(+a.keepalive||M)*N,q=a.publish_key||"",g=a.subscribe_key||"",w=a.ssl?"s":"",y="http"+w+"://"+(a.origin||"pubsub.pubnub.com"),z=Q(y),S=Q(y),s=[],T=0,U=0,J=0,K=0,V=0,E=0,j={},t=a.xdr,L=a._is_online||x(1),v=a.jsonp_cb||x(0),A=a.db||{get:p(),set:p()},B=a.uuid||A&&A.get(g+"uuid")||"",e={_reset_offline:function(){J&&J(1)},
LEAVE:function(a,b){var d={uuid:B},c=Q(y),r=v();0<a.indexOf(G)||("0"!=r&&(d.callback=r),t({l:b||w,timeout:2E3,a:r,data:d,url:[c,"v2","presence","sub_key",g,"channel",Z(a),"leave"]}))},history:function(a,b){var b=a.callback||b,d=a.count||a.limit||100,c=a.reverse||"false",r=a.error||p(),e=a.channel,n=a.start,f=a.end,h={},i=v();if(!e)return error("Missing Channel");if(!b)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");h.stringtoken="true";h.count=d;h.reverse=c;i&&(h.callback=
i);n&&(h.start=n);f&&(h.end=f);t({a:i,data:h,c:function(a){b(a)},b:r,url:[z,"v2","history","sub-key",g,"channel",Z(e)]})},replay:function(a){var b=b||a.callback||p(),d=a.source,c=a.destination,r=a.stop,e=a.start,n=a.end,f=a.reverse,a=a.limit,h=v(),i={};if(!d)return error("Missing Source Channel");if(!c)return error("Missing Destination Channel");if(!q)return error("Missing Publish Key");if(!g)return error("Missing Subscribe Key");"0"!=h&&(i.callback=h);r&&(i.stop="all");f&&(i.reverse="true");e&&(i.start=
e);n&&(i.end=n);a&&(i.count=a);t({a:h,c:function(a){b(a)},b:function(){b([0,"Disconnected"])},url:[z,"v1","replay",q,g,d,c],data:i})},time:function(a){var b=v();t({a:b,timeout:5*N,url:[z,"time",b],c:function(b){a(b[0])},b:function(){a(0)}})},publish:function(a,b){var b=b||a.callback||p(),d=a.message,e=a.channel,r=v();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!q)return error("Missing Publish Key");if(!g)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[z,"publish",q,g,0,Z(e),r,Z(d)];s.push({a:r,timeout:5*N,url:e,data:{uuid:B},c:function(a){b(a);c(1)},b:function(){b([0,"Failed",d]);c(1)}});c()},unsubscribe:function(a){a=a.channel;E=0;K=1;a=Y((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+G}).join(",");W(a.split(","),function(a){D&&e.LEAVE(a,0);j[a]=0});D&&b()},subscribe:function(a,c){function ia(a){a?X(O,N):(z=Q(y,1),S=Q(y,1),X(function(){e.time(ia)},N));d(function(b){if(a&&b.d)return b.d=0,b.j(b.name);!a&&!b.d&&(b.d=1,b.i(b.name))})}
function O(){var a=v(),b=$(j).join(",");b&&(J=t({timeout:q,a:a,b:function(){e.time(ia)},data:{uuid:B},url:[S,"subscribe",g,Z(b),a,E],c:function(a){if(!a)return X(O,u);d(function(a){a.e||(a.e=1,a.h(a.name))});(E=!E&&K&&A.get(g)||a[1])&&A.set(g,a[1]);var b,ha=(2<a.length?a[2]:"").split(",");b=function(){var a=ha.shift()||"";return[(j[a]||{}).a||T,(a||U).split(G)[0]]};W(a[0],function(ha){var d=b();if(j[d[1]].f)d[0](ha,a,d[1])});X(O,u)}}))}var r=a.channel,c=(c=c||a.callback)||a.message,Fa=a.connect||
p(),Ga=a.reconnect||p(),s=a.disconnect||p(),h=a.presence||0,i=a.noheresync||0,q=a.timeout||n,u=a.windowing||f;a.restore&&(K=1);E=0;if(!r)return error("Missing Channel");if(!c)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");W((r.join?r.join(","):""+r).split(","),function(a){var b=j[a]||{};j[U=a]={name:a,e:b.e,d:b.d,f:1,a:T=c,h:Fa,i:s,j:Ga};h&&(e.subscribe({channel:a+G,callback:h}),!b.f&&!i&&e.here_now({channel:a,callback:function(b){W("uuids"in b?b.uuids:[],function(ha){h({action:"join",
uuid:ha,timestamp:P(),occupancy:b.occupancy||1},b,a)})}}))});b=function(){e._reset_offline();clearTimeout(V);V=X(O,100)};if(!D)return F.push(b);b()},here_now:function(a,b){var b=a.callback||b,d=a.error||p(),c=a.channel,r=v(),e=l;if(!c)return error("Missing Channel");if(!b)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");"0"!=r&&(e={},e.callback=r);t({a:r,data:e,c:function(a){b(a)},b:d,url:[z,"v2","presence","sub_key",g,"channel",Z(c)]})},xdr:t,ready:ga,db:A,uuid:R,each:W,
map:Y,grep:ea,supplant:fa,now:P,unique:ba,updater:da,poll_online:function(){L()||e._reset_offline();X(e.poll_online,N)},poll_online2:function(){e.time(function(a){a||e._reset_offline();X(e.poll_online2,u)})}};B||(B=e.uuid());A.set(g+"uuid",B);X(e.poll_online,N);X(e.poll_online2,u);return e}
function ka(a){function b(a){f||(f=1,clearTimeout(u),d&&(d.onerror=d.onload=l,d.abort&&d.abort(),d=l),a&&q())}function c(){if(!n){n=1;clearTimeout(u);try{response=JSON.parse(d.responseText)}catch(a){return b(1)}g(response)}}var d,f=0,n=0,u=X(function(){b(1)},la),q=a.b||p(),g=a.c||p();try{d="undefined"!==typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest;d.onerror=d.onabort=function(){b(1)};d.onload=d.onloadend=c;d.timeout=la;url=a.url.join(ma);if(a.data){var w=[];url+="?";for(key in a.data)w.push(key+
"="+a.data[key]);url+=w.join(na)}d.open("GET",url,k);d.send()}catch(y){return b(0),ka(a)}return b}function oa(a,b,c){W(a.split(","),function(a){function f(a){a||(a=window.event);c(a)||(a.cancelBubble=k,a.returnValue=m,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}b.addEventListener?b.addEventListener(a,f,m):b.attachEvent?b.attachEvent("on"+a,f):b["on"+a]=f})}
function pa(a){a.db=qa;a.xdr=ka;var b=ja(a);b.init=pa;if(a.notest)return b;oa("beforeunload",window,function(){each_channel(function(a){b.LEAVE(a.name,1)});return k});oa("offline",window,b._reset_offline);oa("offline",document,b._reset_offline);b.ready();return b}var ma="/",na="&",la=31E4,qa,ra="undefined"!=typeof localStorage&&localStorage;
qa={get:function(a){try{return ra?ra.getItem(a):-1==document.cookie.indexOf(a)?l:((document.cookie||"").match(RegExp(a+"=([^;]+)"))||[])[1]||l}catch(b){}},set:function(a,b){try{if(ra)return ra.setItem(a,b)&&0;document.cookie=a+"="+b+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(c){}}};"undefined"!==typeof module&&(module.m=pa)||"undefined"!==typeof exports&&(exports.k=pa)||(PUBNUB=pa);C=1;D=m;F=[];G="-pnpres";H=10;I=310;M=60;N=1E3;aa=/{([\w\-]+)}/g;
function ba(){return"x"+ ++C+""+ +new Date}function P(){return+new Date}var sa=Math.floor(20*Math.random());Q=function(a,b){return 0<a.indexOf("pubsub.")&&a.replace("pubsub","ps"+(b?R().split("-")[0]:20>++sa?sa:sa=1))||a};function da(a,b){function c(){f+b>P()?(clearTimeout(d),d=setTimeout(c,b)):(f=P(),a())}var d,f=0;return c}function ea(a,b){var c=[];W(a||[],function(a){b(a)&&c.push(a)});return c}function fa(a,b){return a.replace(aa,function(a,d){return b[d]||a})}
function X(a,b){return setTimeout(a,b)}function R(a){var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});a&&a(b);return b}function W(a,b){if(a&&b)if("undefined"!=typeof a[0])for(var c=0,d=a.length;c<d;)b.call(a[c],a[c],c++);else for(c in a)a.hasOwnProperty&&a.hasOwnProperty(c)&&b.call(a[c],c,a[c])}function Y(a,b){var c=[];W(a||[],function(a,f){c.push(b(a,f))});return c}
function Z(a){return Y(encodeURIComponent(a).split(""),function(a){return 0>"-_.!~*'()".indexOf(a)?a:"%"+a.charCodeAt(0).toString(16).toUpperCase()}).join("")}function $(a){var b=[];W(a,function(a,d){d.f&&b.push(a)});return b.sort()}function ga(){X(function(){D||(D=1,W(F,function(a){a()}))},N)}
function ja(a){function b(){}function c(a){a&&(s.g=0);!s.g&&s.length&&(s.g=1,t(s.shift()))}function d(a){W($(j),function(b){(b=j[b])&&a(b)})}var f=+a.windowing||H,n=(+a.timeout||I)*N,u=(+a.keepalive||M)*N,q=a.publish_key||"",g=a.subscribe_key||"",w=a.ssl?"s":"",y="http"+w+"://"+(a.origin||"pubsub.pubnub.com"),z=Q(y),S=Q(y),s=[],T=0,U=0,J=0,K=0,V=0,E=0,j={},t=a.xdr,L=a._is_online||x(1),v=a.jsonp_cb||x(0),A=a.db||{get:p(),set:p()},B=a.uuid||A&&A.get(g+"uuid")||"",e={_reset_offline:function(){J&&J(1)},
LEAVE:function(a,b){var d={uuid:B},c=Q(y),e=v();0<a.indexOf(G)||("0"!=e&&(d.callback=e),t({l:b||w,timeout:2E3,a:e,data:d,url:[c,"v2","presence","sub_key",g,"channel",Z(a),"leave"]}))},history:function(a,b){var b=a.callback||b,d=a.count||a.limit||100,c=a.reverse||"false",e=a.error||p(),f=a.channel,n=a.start,j=a.end,h={},i=v();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");h.stringtoken="true";h.count=d;h.reverse=c;i&&(h.callback=
i);n&&(h.start=n);j&&(h.end=j);t({a:i,data:h,c:function(a){b(a)},b:e,url:[z,"v2","history","sub-key",g,"channel",Z(f)]})},replay:function(a){var b=b||a.callback||p(),d=a.source,c=a.destination,e=a.stop,f=a.start,n=a.end,j=a.reverse,a=a.limit,h=v(),i={};if(!d)return error("Missing Source Channel");if(!c)return error("Missing Destination Channel");if(!q)return error("Missing Publish Key");if(!g)return error("Missing Subscribe Key");"0"!=h&&(i.callback=h);e&&(i.stop="all");j&&(i.reverse="true");f&&(i.start=
f);n&&(i.end=n);a&&(i.count=a);t({a:h,c:function(a){b(a)},b:function(){b([0,"Disconnected"])},url:[z,"v1","replay",q,g,d,c],data:i})},time:function(a){var b=v();t({a:b,timeout:5*N,url:[z,"time",b],c:function(b){a(b[0])},b:function(){a(0)}})},publish:function(a,b){var b=b||a.callback||p(),d=a.message,e=a.channel,f=v();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!q)return error("Missing Publish Key");if(!g)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[z,"publish",q,g,0,Z(e),f,Z(d)];s.push({a:f,timeout:5*N,url:e,data:{uuid:B},c:function(a){b(a);c(1)},b:function(){b([0,"Failed",d]);c(1)}});c()},unsubscribe:function(a){a=a.channel;E=0;K=1;a=Y((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+G}).join(",");W(a.split(","),function(a){D&&e.LEAVE(a,0);j[a]=0});D&&b()},subscribe:function(a,c){function ia(a){a?X(O,N):(z=Q(y,1),S=Q(y,1),X(function(){e.time(ia)},N));d(function(b){if(a&&b.d)return b.d=0,b.j(b.name);!a&&!b.d&&(b.d=1,b.i(b.name))})}
function O(){var a=v(),b=$(j).join(",");b&&(J=t({timeout:w,a:a,b:function(){e.time(ia)},data:{uuid:B},url:[S,"subscribe",g,Z(b),a,E],c:function(a){if(!a)return X(O,L);d(function(a){a.e||(a.e=1,a.h(a.name))});(E=!E&&K&&A.get(g)||a[1])&&A.set(g,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(j[a]||{}).a||T,(a||U).split(G)[0]]};W(a[0],function(d){var c=b();if(j[c[1]].f)c[0](d,a,c[1])});X(O,L)}}))}var r=a.channel,c=(c=c||a.callback)||a.message,s=a.connect||p(),q=
a.reconnect||p(),u=a.disconnect||p(),h=a.presence||0,i=a.noheresync||0,w=a.timeout||n,L=a.windowing||f;a.restore&&(K=1);E=0;if(!r)return error("Missing Channel");if(!c)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");W((r.join?r.join(","):""+r).split(","),function(a){var b=j[a]||{};j[U=a]={name:a,e:b.e,d:b.d,f:1,a:T=c,h:s,i:u,j:q};h&&(e.subscribe({channel:a+G,callback:h}),!b.f&&!i&&e.here_now({channel:a,callback:function(b){W("uuids"in b?b.uuids:[],function(d){h({action:"join",
uuid:d,timestamp:P(),occupancy:b.occupancy||1},b,a)})}}))});b=function(){e._reset_offline();clearTimeout(V);V=X(O,100)};if(!D)return F.push(b);b()},here_now:function(a,b){var b=a.callback||b,d=a.error||p(),c=a.channel,e=v(),f=l;if(!c)return error("Missing Channel");if(!b)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);t({a:e,data:f,c:function(a){b(a)},b:d,url:[z,"v2","presence","sub_key",g,"channel",Z(c)]})},xdr:t,ready:ga,db:A,uuid:R,each:W,
map:Y,grep:ea,supplant:fa,now:P,unique:ba,updater:da,poll_online:function(){L()||e._reset_offline();X(e.poll_online,N)},poll_online2:function(){e.time(function(a){a||e._reset_offline();X(e.poll_online2,u)})}};B||(B=e.uuid());A.set(g+"uuid",B);X(e.poll_online,N);X(e.poll_online2,u);return e}
function ta(a){function b(a){f||(f=1,clearTimeout(u),d&&(d.onerror=d.onload=l,d.abort&&d.abort(),d=l),a&&q())}function c(){if(!n){n=1;clearTimeout(u);try{response=JSON.parse(d.responseText)}catch(a){return b(1)}g(response)}}var d,f=0,n=0,u=X(function(){b(1)},ua),q=a.b||p(),g=a.c||p();try{d="undefined"!==typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest;d.onerror=d.onabort=function(){b(1)};d.onload=d.onloadend=c;d.timeout=ua;url=a.url.join(wa);if(a.data){var w=[];url+="?";for(key in a.data)w.push(key+
"="+a.data[key]);url+=w.join(xa)}d.open("GET",url,k);d.send()}catch(y){return b(0),ta(a)}return b}function ya(a,b,c){W(a.split(","),function(a){function f(a){a||(a=window.event);c(a)||(a.cancelBubble=k,a.returnValue=m,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}b.addEventListener?b.addEventListener(a,f,m):b.attachEvent?b.attachEvent("on"+a,f):b["on"+a]=f})}
function za(a){a.db=Aa;a.xdr=ta;var b=ja(a);b.init=za;if(a.notest)return b;ya("beforeunload",window,function(){each_channel(function(a){b.LEAVE(a.name,1)});return k});ya("offline",window,b._reset_offline);ya("offline",document,b._reset_offline);b.ready();return b}var wa="/",xa="&",ua=31E4,Aa,Ba="undefined"!=typeof localStorage&&localStorage;
Aa={get:function(a){try{return Ba?Ba.getItem(a):-1==document.cookie.indexOf(a)?l:((document.cookie||"").match(RegExp(a+"=([^;]+)"))||[])[1]||l}catch(b){}},set:function(a,b){try{if(Ba)return Ba.setItem(a,b)&&0;document.cookie=a+"="+b+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(c){}}};"undefined"!==typeof module&&(module.m=za)||"undefined"!==typeof exports&&(exports.k=za)||(PUBNUB=za);C=1;D=m;F=[];G="-pnpres";H=10;I=310;M=60;N=1E3;aa=/{([\w\-]+)}/g;
function ba(){return"x"+ ++C+""+ +new Date}function P(){return+new Date}var Ca=Math.floor(20*Math.random());Q=function(a,b){return 0<a.indexOf("pubsub.")&&a.replace("pubsub","ps"+(b?R().split("-")[0]:20>++Ca?Ca:Ca=1))||a};function da(a,b){function c(){f+b>P()?(clearTimeout(d),d=setTimeout(c,b)):(f=P(),a())}var d,f=0;return c}function ea(a,b){var c=[];W(a||[],function(a){b(a)&&c.push(a)});return c}function fa(a,b){return a.replace(aa,function(a,d){return b[d]||a})}
function X(a,b){return setTimeout(a,b)}function R(a){var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});a&&a(b);return b}function W(a,b){if(a&&b)if("undefined"!=typeof a[0])for(var c=0,d=a.length;c<d;)b.call(a[c],a[c],c++);else for(c in a)a.hasOwnProperty&&a.hasOwnProperty(c)&&b.call(a[c],c,a[c])}function Y(a,b){var c=[];W(a||[],function(a,f){c.push(b(a,f))});return c}
function Z(a){return Y(encodeURIComponent(a).split(""),function(a){return 0>"-_.!~*'()".indexOf(a)?a:"%"+a.charCodeAt(0).toString(16).toUpperCase()}).join("")}function $(a){var b=[];W(a,function(a,d){d.f&&b.push(a)});return b.sort()}function ga(){X(function(){D||(D=1,W(F,function(a){a()}))},N)}
function ja(a){function b(){}function c(a){a&&(s.g=0);!s.g&&s.length&&(s.g=1,t(s.shift()))}function d(a){W($(j),function(b){(b=j[b])&&a(b)})}var f=+a.windowing||H,n=(+a.timeout||I)*N,u=(+a.keepalive||M)*N,q=a.publish_key||"",g=a.subscribe_key||"",w=a.ssl?"s":"",y="http"+w+"://"+(a.origin||"pubsub.pubnub.com"),z=Q(y),S=Q(y),s=[],T=0,U=0,J=0,K=0,V=0,E=0,j={},t=a.xdr,L=a._is_online||x(1),v=a.jsonp_cb||x(0),A=a.db||{get:p(),set:p()},B=a.uuid||A&&A.get(g+"uuid")||"",e={_reset_offline:function(){J&&J(1)},
LEAVE:function(a,b){var d={uuid:B},c=Q(y),e=v();0<a.indexOf(G)||("0"!=e&&(d.callback=e),t({l:b||w,timeout:2E3,a:e,data:d,url:[c,"v2","presence","sub_key",g,"channel",Z(a),"leave"]}))},history:function(a,b){var b=a.callback||b,d=a.count||a.limit||100,c=a.reverse||"false",e=a.error||p(),f=a.channel,n=a.start,j=a.end,h={},i=v();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");h.stringtoken="true";h.count=d;h.reverse=c;i&&(h.callback=
i);n&&(h.start=n);j&&(h.end=j);t({a:i,data:h,c:function(a){b(a)},b:e,url:[z,"v2","history","sub-key",g,"channel",Z(f)]})},replay:function(a){var b=b||a.callback||p(),d=a.source,c=a.destination,e=a.stop,f=a.start,n=a.end,j=a.reverse,a=a.limit,h=v(),i={};if(!d)return error("Missing Source Channel");if(!c)return error("Missing Destination Channel");if(!q)return error("Missing Publish Key");if(!g)return error("Missing Subscribe Key");"0"!=h&&(i.callback=h);e&&(i.stop="all");j&&(i.reverse="true");f&&(i.start=
f);n&&(i.end=n);a&&(i.count=a);t({a:h,c:function(a){b(a)},b:function(){b([0,"Disconnected"])},url:[z,"v1","replay",q,g,d,c],data:i})},time:function(a){var b=v();t({a:b,timeout:5*N,url:[z,"time",b],c:function(b){a(b[0])},b:function(){a(0)}})},publish:function(a,b){var b=b||a.callback||p(),d=a.message,e=a.channel,f=v();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!q)return error("Missing Publish Key");if(!g)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[z,"publish",q,g,0,Z(e),f,Z(d)];s.push({a:f,timeout:5*N,url:e,data:{uuid:B},c:function(a){b(a);c(1)},b:function(){b([0,"Failed",d]);c(1)}});c()},unsubscribe:function(a){a=a.channel;E=0;K=1;a=Y((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+G}).join(",");W(a.split(","),function(a){D&&e.LEAVE(a,0);j[a]=0});D&&b()},subscribe:function(a,c){function s(a){a?X(q,N):(z=Q(y,1),S=Q(y,1),X(function(){e.time(s)},N));d(function(b){if(a&&b.d)return b.d=0,b.j(b.name);!a&&!b.d&&(b.d=1,b.i(b.name))})}
function q(){var a=v(),b=$(j).join(",");b&&(J=t({timeout:Ha,a:a,b:function(){e.time(s)},data:{uuid:B},url:[S,"subscribe",g,Z(b),a,E],c:function(a){if(!a)return X(q,va);d(function(a){a.e||(a.e=1,a.h(a.name))});(E=!E&&K&&A.get(g)||a[1])&&A.set(g,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(j[a]||{}).a||T,(a||U).split(G)[0]]};W(a[0],function(d){var c=b();if(j[c[1]].f)c[0](d,a,c[1])});X(q,va)}}))}var r=a.channel,c=(c=c||a.callback)||a.message,u=a.connect||p(),
w=a.reconnect||p(),L=a.disconnect||p(),h=a.presence||0,i=a.noheresync||0,Ha=a.timeout||n,va=a.windowing||f;a.restore&&(K=1);E=0;if(!r)return error("Missing Channel");if(!c)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");W((r.join?r.join(","):""+r).split(","),function(a){var b=j[a]||{};j[U=a]={name:a,e:b.e,d:b.d,f:1,a:T=c,h:u,i:L,j:w};h&&(e.subscribe({channel:a+G,callback:h}),!b.f&&!i&&e.here_now({channel:a,callback:function(b){W("uuids"in b?b.uuids:[],function(d){h({action:"join",
uuid:d,timestamp:P(),occupancy:b.occupancy||1},b,a)})}}))});b=function(){e._reset_offline();clearTimeout(V);V=X(q,100)};if(!D)return F.push(b);b()},here_now:function(a,b){var b=a.callback||b,d=a.error||p(),c=a.channel,e=v(),f=l;if(!c)return error("Missing Channel");if(!b)return error("Missing Callback");if(!g)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);t({a:e,data:f,c:function(a){b(a)},b:d,url:[z,"v2","presence","sub_key",g,"channel",Z(c)]})},xdr:t,ready:ga,db:A,uuid:R,each:W,
map:Y,grep:ea,supplant:fa,now:P,unique:ba,updater:da,poll_online:function(){L()||e._reset_offline();X(e.poll_online,N)},poll_online2:function(){e.time(function(a){a||e._reset_offline();X(e.poll_online2,u)})}};B||(B=e.uuid());A.set(g+"uuid",B);X(e.poll_online,N);X(e.poll_online2,u);return e}
function Da(a){function b(a){f||(f=1,clearTimeout(u),d&&(d.onerror=d.onload=l,d.abort&&d.abort(),d=l),a&&q())}function c(){if(!n){n=1;clearTimeout(u);try{response=JSON.parse(d.responseText)}catch(a){return b(1)}g(response)}}var d,f=0,n=0,u=X(function(){b(1)},Ea),q=a.b||p(),g=a.c||p();try{d="undefined"!==typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest;d.onerror=d.onabort=function(){b(1)};d.onload=d.onloadend=c;d.timeout=Ea;url=a.url.join(Ia);if(a.data){var w=[];url+="?";for(key in a.data)w.push(key+
"="+a.data[key]);url+=w.join(Ja)}d.open("GET",url,k);d.send()}catch(y){return b(0),Da(a)}return b}function Ka(a,b,c){W(a.split(","),function(a){function f(a){a||(a=window.event);c(a)||(a.cancelBubble=k,a.returnValue=m,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}b.addEventListener?b.addEventListener(a,f,m):b.attachEvent?b.attachEvent("on"+a,f):b["on"+a]=f})}
function La(a){a.db=Ma;a.xdr=Da;var b=ja(a);b.init=La;if(a.notest)return b;Ka("beforeunload",window,function(){each_channel(function(a){b.LEAVE(a.name,1)});return k});Ka("offline",window,b._reset_offline);Ka("offline",document,b._reset_offline);b.ready();return b}var Ia="/",Ja="&",Ea=31E4,Ma,Na="undefined"!=typeof localStorage&&localStorage;
Ma={get:function(a){try{return Na?Na.getItem(a):-1==document.cookie.indexOf(a)?l:((document.cookie||"").match(RegExp(a+"=([^;]+)"))||[])[1]||l}catch(b){}},set:function(a,b){try{if(Na)return Na.setItem(a,b)&&0;document.cookie=a+"="+b+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(c){}}};"undefined"!==typeof module&&(module.m=La)||"undefined"!==typeof exports&&(exports.k=La)||(PUBNUB=La);
})();
