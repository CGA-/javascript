// 3.4.3
(function(){
function aa(b){throw b;}var q=!0,t=null,u=!1;function v(){return function(){}}function z(b){return function(){return b}}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();var ba=1,A=u,E=[],H="-pnpres",ca=10,I=1E4,da=310,ea=60,J=1E3,fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var O,ha=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++ha?ha:ha=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),h=a.channel,f=a.start,i=a.end,k={},r=C();if(!h)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");k.stringtoken="true";k.count=c;k.reverse=d;r&&(k.callback=
r);f&&(k.start=f);i&&(k.end=i);y({a:r,data:k,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(h)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,h=a.start,f=a.end,i=a.reverse,a=a.limit,k=C(),r={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=k&&(r.callback=k);e&&(r.stop="all");i&&(r.reverse="true");h&&(r.start=
h);f&&(r.end=f);a&&(r.count=a);y({a:k,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:r})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,h=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),h,Y(d)];m.push({a:h,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function r(a){a?V(l,J):(g=O(h,1),i=O(h,1),V(function(){s.time(r)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function l(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:W,a:a,c:function(){s.time(r)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(l,N);d(function(a){a.g||(a.g=1,a.k(a.name))});(B=!B&&D&&F.get(p)||a[1])&&F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(l,N)}}))}var m=a.channel,b=(b=b||a.callback)||a.message,Ta=a.connect||v(),w=
a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.timeout||k,N=a.windowing||e;a.restore&&(D=1);B=0;if(!m)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((m.join?m.join(","):""+m).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:Ta,l:ja,m:w};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in b?b.uuids:[],function(c){Q({action:"join",
uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(l,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),h=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(h={},h.callback=e);y({a:e,data:h,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,
map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var na=function(b){return document.getElementById(b)},oa=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},pa=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},qa=
function(){return oa("head")[0]},ra=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},sa=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},ta=function(b){return document.createElement(b)},wa=function(){return ua||va()?0:L()},za=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=na(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(ua||va()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=va()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(xa);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(ya)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);ua=0;b=za(b);break a}b=g}return b}var n=ta("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[Aa]=Aa);n.onerror=function(){c(1)};n.src=b.url.join(xa);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(ya)}ra(n,"id",f);qa().appendChild(n);return c},Ba=function(){return!("onLine"in
navigator)?1:navigator.onLine},va=function(){if(!Ca||!Ca.get)return 0;var b={id:va.id++,send:v(),abort:function(){b.id={}},open:function(c,a){va[b.id]=b;Ca.get(b.id,a)}};return b},Aa="async",xa="/",ya="&",ua=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var Da,Ea=window.localStorage;Da={get:function(b){try{return Ea?Ea.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(Ea)return Ea.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var Fa={list:{},unbind:function(b){Fa.list[b]=[]},bind:function(b,c){(Fa.list[b]=Fa.list[b]||[]).push(c)},fire:function(b,c){T(Fa.list[b]||[],function(a){a(c)})}},Ga=na("pubnub")||0,Ha=function(b){b.jsonp&&(ua=0);var c=b.subscribe_key||"";b.uuid||Da.get(c+"uuid");b.xdr=za;b.db=Da;b._is_online=Ba;b.jsonp_cb=
wa;var a=ma(b);a.css=sa;a.$=na;a.create=ta;a.bind=pa;a.head=qa;a.search=oa;a.attr=ra;a.events=Fa;a.init=Ha;if(b.notest)return a;pa("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});pa("offline",window,a._reset_offline);pa("offline",document,a._reset_offline);return a};pa("load",window,function(){V($,0)});var Ia=Ga||{};PUBNUB=Ha({notest:1,publish_key:ra(Ia,"pub-key"),subscribe_key:ra(Ia,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==ra(Ia,"ssl"),
origin:ra(Ia,"origin"),uuid:ra(Ia,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var Ca=na("pubnubs")||0;if(Ga){sa(Ga,{position:"absolute",top:-J});if("opera"in window||ra(Ga,"flash"))Ga.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return va[b].onerror();
va[b].responseText=unescape(c);va[b].onload()};va.id=J}}
var Ja=PUBNUB.ws=function(b,c){if(!(this instanceof Ja))return new Ja(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Ja.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var Ka=PUBNUB.ws=function(b,c){if(!(this instanceof Ka))return new Ka(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Ka.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var La=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++La?La:La=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,k={},r=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");k.stringtoken="true";k.count=c;k.reverse=d;r&&(k.callback=
r);h&&(k.start=h);i&&(k.end=i);y({a:r,data:k,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,k=C(),r={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=k&&(r.callback=k);e&&(r.stop="all");i&&(r.reverse="true");f&&(r.start=
f);h&&(r.end=h);a&&(r.count=a);y({a:k,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:r})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function r(a){a?V(l,J):(g=O(h,1),i=O(h,1),V(function(){s.time(r)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function l(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:W,a:a,c:function(){s.time(r)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(l,N);d(function(a){a.g||(a.g=1,a.k(a.name))});(B=!B&&D&&F.get(p)||a[1])&&F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(l,N)}}))}var m=a.channel,b=(b=b||a.callback)||a.message,Ta=a.connect||v(),w=
a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.timeout||k,N=a.windowing||e;a.restore&&(D=1);B=0;if(!m)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((m.join?m.join(","):""+m).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:Ta,l:ja,m:w};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in b?b.uuids:[],function(c){Q({action:"join",
uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(l,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,
map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var Ma=function(b){return document.getElementById(b)},Na=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},Oa=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},Pa=
function(){return Na("head")[0]},Qa=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},Ra=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},Sa=function(b){return document.createElement(b)},Wa=function(){return Ua||Va()?0:L()},Za=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=Ma(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(Ua||Va()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=Va()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(Xa);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(Ya)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);Ua=0;b=Za(b);break a}b=g}return b}var n=Sa("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[$a]=$a);n.onerror=function(){c(1)};n.src=b.url.join(Xa);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(Ya)}Qa(n,"id",f);Pa().appendChild(n);return c},ab=function(){return!("onLine"in
navigator)?1:navigator.onLine},Va=function(){if(!bb||!bb.get)return 0;var b={id:Va.id++,send:v(),abort:function(){b.id={}},open:function(c,a){Va[b.id]=b;bb.get(b.id,a)}};return b},$a="async",Xa="/",Ya="&",Ua=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var cb,db=window.localStorage;cb={get:function(b){try{return db?db.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(db)return db.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var eb={list:{},unbind:function(b){eb.list[b]=[]},bind:function(b,c){(eb.list[b]=eb.list[b]||[]).push(c)},fire:function(b,c){T(eb.list[b]||[],function(a){a(c)})}},fb=Ma("pubnub")||0,gb=function(b){b.jsonp&&(Ua=0);var c=b.subscribe_key||"";b.uuid||cb.get(c+"uuid");b.xdr=Za;b.db=cb;b._is_online=ab;b.jsonp_cb=
Wa;var a=ma(b);a.css=Ra;a.$=Ma;a.create=Sa;a.bind=Oa;a.head=Pa;a.search=Na;a.attr=Qa;a.events=eb;a.init=gb;if(b.notest)return a;Oa("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});Oa("offline",window,a._reset_offline);Oa("offline",document,a._reset_offline);return a};Oa("load",window,function(){V($,0)});var hb=fb||{};PUBNUB=gb({notest:1,publish_key:Qa(hb,"pub-key"),subscribe_key:Qa(hb,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==Qa(hb,"ssl"),
origin:Qa(hb,"origin"),uuid:Qa(hb,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var bb=Ma("pubnubs")||0;if(fb){Ra(fb,{position:"absolute",top:-J});if("opera"in window||Qa(fb,"flash"))fb.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return Va[b].onerror();
Va[b].responseText=unescape(c);Va[b].onload()};Va.id=J}}
var ib=PUBNUB.ws=function(b,c){if(!(this instanceof ib))return new ib(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
ib.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var jb=PUBNUB.ws=function(b,c){if(!(this instanceof jb))return new jb(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
jb.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var kb=function(b){return document.getElementById(b)},lb=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},mb=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},nb=
function(){return lb("head")[0]},ob=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},pb=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},qb=function(b){return document.createElement(b)},tb=function(){return rb||sb()?0:L()},wb=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=kb(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(rb||sb()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=sb()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(ub);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(vb)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);rb=0;b=wb(b);break a}b=g}return b}var n=qb("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[xb]=xb);n.onerror=function(){c(1)};n.src=b.url.join(ub);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(vb)}ob(n,"id",f);nb().appendChild(n);return c},yb=function(){return!("onLine"in
navigator)?1:navigator.onLine},sb=function(){if(!zb||!zb.get)return 0;var b={id:sb.id++,send:v(),abort:function(){b.id={}},open:function(c,a){sb[b.id]=b;zb.get(b.id,a)}};return b},xb="async",ub="/",vb="&",rb=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var Ab,Bb=window.localStorage;Ab={get:function(b){try{return Bb?Bb.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(Bb)return Bb.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var Cb={list:{},unbind:function(b){Cb.list[b]=[]},bind:function(b,c){(Cb.list[b]=Cb.list[b]||[]).push(c)},fire:function(b,c){T(Cb.list[b]||[],function(a){a(c)})}},Db=kb("pubnub")||0,Eb=function(b){b.jsonp&&(rb=0);var c=b.subscribe_key||"";b.uuid||Ab.get(c+"uuid");b.xdr=wb;b.db=Ab;b._is_online=yb;b.jsonp_cb=
tb;var a=ma(b);a.css=pb;a.$=kb;a.create=qb;a.bind=mb;a.head=nb;a.search=lb;a.attr=ob;a.events=Cb;a.init=Eb;if(b.notest)return a;mb("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});mb("offline",window,a._reset_offline);mb("offline",document,a._reset_offline);return a};mb("load",window,function(){V($,0)});var Fb=Db||{};PUBNUB=Eb({notest:1,publish_key:ob(Fb,"pub-key"),subscribe_key:ob(Fb,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==ob(Fb,"ssl"),
origin:ob(Fb,"origin"),uuid:ob(Fb,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var zb=kb("pubnubs")||0;if(Db){pb(Db,{position:"absolute",top:-J});if("opera"in window||ob(Db,"flash"))Db.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return sb[b].onerror();
sb[b].responseText=unescape(c);sb[b].onload()};sb.id=J}}
var Gb=PUBNUB.ws=function(b,c){if(!(this instanceof Gb))return new Gb(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Gb.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var Hb=PUBNUB.ws=function(b,c){if(!(this instanceof Hb))return new Hb(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Hb.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var Ib=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++Ib?Ib:Ib=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,k={},j=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");k.stringtoken="true";k.count=c;k.reverse=d;j&&(k.callback=
j);h&&(k.start=h);i&&(k.end=i);y({a:j,data:k,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,k=C(),j={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=k&&(j.callback=k);e&&(j.stop="all");i&&(j.reverse="true");f&&(j.start=
f);h&&(j.end=h);a&&(j.count=a);y({a:k,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:j})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(r,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function r(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:W,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(r,N);d(function(a){a.g||(a.g=1,a.k(a.name))});(B=!B&&D&&F.get(p)||a[1])&&F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(r,N)}}))}var m=a.channel,b=(b=b||a.callback)||a.message,Ta=a.connect||v(),w=
a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.timeout||k,N=a.windowing||e;a.restore&&(D=1);B=0;if(!m)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((m.join?m.join(","):""+m).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:Ta,l:ja,m:w};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in b?b.uuids:[],function(c){Q({action:"join",
uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(r,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,
map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var Jb=function(b){return document.getElementById(b)},Kb=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},Lb=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},Mb=
function(){return Kb("head")[0]},Nb=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},Ob=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},Pb=function(b){return document.createElement(b)},Sb=function(){return Qb||Rb()?0:L()},Vb=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=Jb(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(Qb||Rb()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=Rb()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(Tb);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(Ub)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);Qb=0;b=Vb(b);break a}b=g}return b}var n=Pb("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[Wb]=Wb);n.onerror=function(){c(1)};n.src=b.url.join(Tb);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(Ub)}Nb(n,"id",f);Mb().appendChild(n);return c},Xb=function(){return!("onLine"in
navigator)?1:navigator.onLine},Rb=function(){if(!Yb||!Yb.get)return 0;var b={id:Rb.id++,send:v(),abort:function(){b.id={}},open:function(c,a){Rb[b.id]=b;Yb.get(b.id,a)}};return b},Wb="async",Tb="/",Ub="&",Qb=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var Zb,$b=window.localStorage;Zb={get:function(b){try{return $b?$b.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if($b)return $b.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var ac={list:{},unbind:function(b){ac.list[b]=[]},bind:function(b,c){(ac.list[b]=ac.list[b]||[]).push(c)},fire:function(b,c){T(ac.list[b]||[],function(a){a(c)})}},bc=Jb("pubnub")||0,cc=function(b){b.jsonp&&(Qb=0);var c=b.subscribe_key||"";b.uuid||Zb.get(c+"uuid");b.xdr=Vb;b.db=Zb;b._is_online=Xb;b.jsonp_cb=
Sb;var a=ma(b);a.css=Ob;a.$=Jb;a.create=Pb;a.bind=Lb;a.head=Mb;a.search=Kb;a.attr=Nb;a.events=ac;a.init=cc;if(b.notest)return a;Lb("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});Lb("offline",window,a._reset_offline);Lb("offline",document,a._reset_offline);return a};Lb("load",window,function(){V($,0)});var dc=bc||{};PUBNUB=cc({notest:1,publish_key:Nb(dc,"pub-key"),subscribe_key:Nb(dc,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==Nb(dc,"ssl"),
origin:Nb(dc,"origin"),uuid:Nb(dc,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var Yb=Jb("pubnubs")||0;if(bc){Ob(bc,{position:"absolute",top:-J});if("opera"in window||Nb(bc,"flash"))bc.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return Rb[b].onerror();
Rb[b].responseText=unescape(c);Rb[b].onload()};Rb.id=J}}
var ec=PUBNUB.ws=function(b,c){if(!(this instanceof ec))return new ec(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
ec.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var fc=PUBNUB.ws=function(b,c){if(!(this instanceof fc))return new fc(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
fc.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var gc=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++gc?gc:gc=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,k={},j=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");k.stringtoken="true";k.count=c;k.reverse=d;j&&(k.callback=
j);h&&(k.start=h);i&&(k.end=i);y({a:j,data:k,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,k=C(),j={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=k&&(j.callback=k);e&&(j.stop="all");i&&(j.reverse="true");f&&(j.start=
f);h&&(j.end=h);a&&(j.count=a);y({a:k,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:j})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(r,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function r(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:W,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(r,N);d(function(a){a.g||(a.g=1,a.k(a.name))});(B=!B&&D&&F.get(p)||a[1])&&F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(r,N)}}))}var m=a.channel,b=(b=b||a.callback)||a.message,Ta=a.connect||v(),w=
a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.timeout||k,N=a.windowing||e;a.restore&&(D=1);B=0;if(!m)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((m.join?m.join(","):""+m).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:Ta,l:ja,m:w};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in b?b.uuids:[],function(c){Q({action:"join",
uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(r,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,
map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var hc=function(b){return document.getElementById(b)},ic=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},jc=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},kc=
function(){return ic("head")[0]},lc=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},mc=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},nc=function(b){return document.createElement(b)},qc=function(){return oc||pc()?0:L()},tc=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=hc(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(oc||pc()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=pc()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(rc);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(sc)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);oc=0;b=tc(b);break a}b=g}return b}var n=nc("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[uc]=uc);n.onerror=function(){c(1)};n.src=b.url.join(rc);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(sc)}lc(n,"id",f);kc().appendChild(n);return c},vc=function(){return!("onLine"in
navigator)?1:navigator.onLine},pc=function(){if(!wc||!wc.get)return 0;var b={id:pc.id++,send:v(),abort:function(){b.id={}},open:function(c,a){pc[b.id]=b;wc.get(b.id,a)}};return b},uc="async",rc="/",sc="&",oc=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var xc,yc=window.localStorage;xc={get:function(b){try{return yc?yc.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(yc)return yc.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var zc={list:{},unbind:function(b){zc.list[b]=[]},bind:function(b,c){(zc.list[b]=zc.list[b]||[]).push(c)},fire:function(b,c){T(zc.list[b]||[],function(a){a(c)})}},Ac=hc("pubnub")||0,Bc=function(b){b.jsonp&&(oc=0);var c=b.subscribe_key||"";b.uuid||xc.get(c+"uuid");b.xdr=tc;b.db=xc;b._is_online=vc;b.jsonp_cb=
qc;var a=ma(b);a.css=mc;a.$=hc;a.create=nc;a.bind=jc;a.head=kc;a.search=ic;a.attr=lc;a.events=zc;a.init=Bc;if(b.notest)return a;jc("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});jc("offline",window,a._reset_offline);jc("offline",document,a._reset_offline);return a};jc("load",window,function(){V($,0)});var Cc=Ac||{};PUBNUB=Bc({notest:1,publish_key:lc(Cc,"pub-key"),subscribe_key:lc(Cc,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==lc(Cc,"ssl"),
origin:lc(Cc,"origin"),uuid:lc(Cc,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var wc=hc("pubnubs")||0;if(Ac){mc(Ac,{position:"absolute",top:-J});if("opera"in window||lc(Ac,"flash"))Ac.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return pc[b].onerror();
pc[b].responseText=unescape(c);pc[b].onload()};pc.id=J}}
var Dc=PUBNUB.ws=function(b,c){if(!(this instanceof Dc))return new Dc(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Dc.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var Ec=PUBNUB.ws=function(b,c){if(!(this instanceof Ec))return new Ec(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Ec.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var Fc=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++Fc?Fc:Fc=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,k={},j=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");k.stringtoken="true";k.count=c;k.reverse=d;j&&(k.callback=
j);h&&(k.start=h);i&&(k.end=i);y({a:j,data:k,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,k=C(),j={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=k&&(j.callback=k);e&&(j.stop="all");i&&(j.reverse="true");f&&(j.start=
f);h&&(j.end=h);a&&(j.count=a);y({a:k,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:j})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(r,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function r(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:W,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(r,N);d(function(a){a.g||(a.g=1,a.k(a.name))});(B=!B&&D&&F.get(p)||a[1])&&F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(r,N)}}))}var m=a.channel,b=(b=b||a.callback)||a.message,w=a.connect||v(),la=
a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.timeout||k,N=a.windowing||e;a.restore&&(D=1);B=0;if(!m)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((m.join?m.join(","):""+m).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:ja,m:la};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in b?b.uuids:[],function(c){Q({action:"join",
uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(r,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,
map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var Gc=function(b){return document.getElementById(b)},Hc=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},Ic=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},Jc=
function(){return Hc("head")[0]},Kc=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},Lc=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},Mc=function(b){return document.createElement(b)},Pc=function(){return Nc||Oc()?0:L()},Sc=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=Gc(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(Nc||Oc()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=Oc()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(Qc);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(Rc)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);Nc=0;b=Sc(b);break a}b=g}return b}var n=Mc("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[Tc]=Tc);n.onerror=function(){c(1)};n.src=b.url.join(Qc);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(Rc)}Kc(n,"id",f);Jc().appendChild(n);return c},Uc=function(){return!("onLine"in
navigator)?1:navigator.onLine},Oc=function(){if(!Vc||!Vc.get)return 0;var b={id:Oc.id++,send:v(),abort:function(){b.id={}},open:function(c,a){Oc[b.id]=b;Vc.get(b.id,a)}};return b},Tc="async",Qc="/",Rc="&",Nc=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var Wc,Xc=window.localStorage;Wc={get:function(b){try{return Xc?Xc.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(Xc)return Xc.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var Yc={list:{},unbind:function(b){Yc.list[b]=[]},bind:function(b,c){(Yc.list[b]=Yc.list[b]||[]).push(c)},fire:function(b,c){T(Yc.list[b]||[],function(a){a(c)})}},Zc=Gc("pubnub")||0,$c=function(b){b.jsonp&&(Nc=0);var c=b.subscribe_key||"";b.uuid||Wc.get(c+"uuid");b.xdr=Sc;b.db=Wc;b._is_online=Uc;b.jsonp_cb=
Pc;var a=ma(b);a.css=Lc;a.$=Gc;a.create=Mc;a.bind=Ic;a.head=Jc;a.search=Hc;a.attr=Kc;a.events=Yc;a.init=$c;if(b.notest)return a;Ic("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});Ic("offline",window,a._reset_offline);Ic("offline",document,a._reset_offline);return a};Ic("load",window,function(){V($,0)});var ad=Zc||{};PUBNUB=$c({notest:1,publish_key:Kc(ad,"pub-key"),subscribe_key:Kc(ad,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==Kc(ad,"ssl"),
origin:Kc(ad,"origin"),uuid:Kc(ad,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var Vc=Gc("pubnubs")||0;if(Zc){Lc(Zc,{position:"absolute",top:-J});if("opera"in window||Kc(Zc,"flash"))Zc.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return Oc[b].onerror();
Oc[b].responseText=unescape(c);Oc[b].onload()};Oc.id=J}}
var bd=PUBNUB.ws=function(b,c){if(!(this instanceof bd))return new bd(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
bd.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var cd=PUBNUB.ws=function(b,c){if(!(this instanceof cd))return new cd(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
cd.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var dd=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++dd?dd:dd=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:N,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),la=a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,N=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:ja,m:la};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var ed=function(b){return document.getElementById(b)},fd=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},gd=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},hd=
function(){return fd("head")[0]},id=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},jd=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},kd=function(b){return document.createElement(b)},nd=function(){return ld||md()?0:L()},qd=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=ed(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(ld||md()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=md()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(od);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(pd)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);ld=0;b=qd(b);break a}b=g}return b}var n=kd("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[rd]=rd);n.onerror=function(){c(1)};n.src=b.url.join(od);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(pd)}id(n,"id",f);hd().appendChild(n);return c},sd=function(){return!("onLine"in
navigator)?1:navigator.onLine},md=function(){if(!td||!td.get)return 0;var b={id:md.id++,send:v(),abort:function(){b.id={}},open:function(c,a){md[b.id]=b;td.get(b.id,a)}};return b},rd="async",od="/",pd="&",ld=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var ud,vd=window.localStorage;ud={get:function(b){try{return vd?vd.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(vd)return vd.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var wd={list:{},unbind:function(b){wd.list[b]=[]},bind:function(b,c){(wd.list[b]=wd.list[b]||[]).push(c)},fire:function(b,c){T(wd.list[b]||[],function(a){a(c)})}},xd=ed("pubnub")||0,yd=function(b){b.jsonp&&(ld=0);var c=b.subscribe_key||"";b.uuid||ud.get(c+"uuid");b.xdr=qd;b.db=ud;b._is_online=sd;b.jsonp_cb=
nd;var a=ma(b);a.css=jd;a.$=ed;a.create=kd;a.bind=gd;a.head=hd;a.search=fd;a.attr=id;a.events=wd;a.init=yd;if(b.notest)return a;gd("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});gd("offline",window,a._reset_offline);gd("offline",document,a._reset_offline);return a};gd("load",window,function(){V($,0)});var zd=xd||{};PUBNUB=yd({notest:1,publish_key:id(zd,"pub-key"),subscribe_key:id(zd,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==id(zd,"ssl"),
origin:id(zd,"origin"),uuid:id(zd,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var td=ed("pubnubs")||0;if(xd){jd(xd,{position:"absolute",top:-J});if("opera"in window||id(xd,"flash"))xd.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return md[b].onerror();
md[b].responseText=unescape(c);md[b].onload()};md.id=J}}
var Ad=PUBNUB.ws=function(b,c){if(!(this instanceof Ad))return new Ad(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Ad.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var Bd=PUBNUB.ws=function(b,c){if(!(this instanceof Bd))return new Bd(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Bd.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var Cd=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++Cd?Cd:Cd=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:N,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),la=a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,N=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:ja,m:la};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var Dd=function(b){return document.getElementById(b)},Ed=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},Fd=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},Gd=
function(){return Ed("head")[0]},Hd=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},Id=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},Jd=function(b){return document.createElement(b)},Md=function(){return Kd||Ld()?0:L()},Pd=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=Dd(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(Kd||Ld()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=Ld()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(Nd);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(Od)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);Kd=0;b=Pd(b);break a}b=g}return b}var n=Jd("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[Qd]=Qd);n.onerror=function(){c(1)};n.src=b.url.join(Nd);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(Od)}Hd(n,"id",f);Gd().appendChild(n);return c},Rd=function(){return!("onLine"in
navigator)?1:navigator.onLine},Ld=function(){if(!Sd||!Sd.get)return 0;var b={id:Ld.id++,send:v(),abort:function(){b.id={}},open:function(c,a){Ld[b.id]=b;Sd.get(b.id,a)}};return b},Qd="async",Nd="/",Od="&",Kd=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var Td,Ud=window.localStorage;Td={get:function(b){try{return Ud?Ud.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(Ud)return Ud.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var Vd={list:{},unbind:function(b){Vd.list[b]=[]},bind:function(b,c){(Vd.list[b]=Vd.list[b]||[]).push(c)},fire:function(b,c){T(Vd.list[b]||[],function(a){a(c)})}},Wd=Dd("pubnub")||0,Xd=function(b){b.jsonp&&(Kd=0);var c=b.subscribe_key||"";b.uuid||Td.get(c+"uuid");b.xdr=Pd;b.db=Td;b._is_online=Rd;b.jsonp_cb=
Md;var a=ma(b);a.css=Id;a.$=Dd;a.create=Jd;a.bind=Fd;a.head=Gd;a.search=Ed;a.attr=Hd;a.events=Vd;a.init=Xd;if(b.notest)return a;Fd("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});Fd("offline",window,a._reset_offline);Fd("offline",document,a._reset_offline);return a};Fd("load",window,function(){V($,0)});var Yd=Wd||{};PUBNUB=Xd({notest:1,publish_key:Hd(Yd,"pub-key"),subscribe_key:Hd(Yd,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==Hd(Yd,"ssl"),
origin:Hd(Yd,"origin"),uuid:Hd(Yd,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var Sd=Dd("pubnubs")||0;if(Wd){Id(Wd,{position:"absolute",top:-J});if("opera"in window||Hd(Wd,"flash"))Wd.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return Ld[b].onerror();
Ld[b].responseText=unescape(c);Ld[b].onload()};Ld.id=J}}
var Zd=PUBNUB.ws=function(b,c){if(!(this instanceof Zd))return new Zd(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Zd.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var $d=PUBNUB.ws=function(b,c){if(!(this instanceof $d))return new $d(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
$d.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var ae=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++ae?ae:ae=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:ka,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),la=a.reconnect||v(),N=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,ka=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:N,m:la};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var be=function(b){return document.getElementById(b)},ce=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},de=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},ee=
function(){return ce("head")[0]},fe=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},ge=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},he=function(b){return document.createElement(b)},ke=function(){return ie||je()?0:L()},ne=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=be(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(ie||je()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=je()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(le);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(me)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);ie=0;b=ne(b);break a}b=g}return b}var n=he("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[oe]=oe);n.onerror=function(){c(1)};n.src=b.url.join(le);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(me)}fe(n,"id",f);ee().appendChild(n);return c},pe=function(){return!("onLine"in
navigator)?1:navigator.onLine},je=function(){if(!qe||!qe.get)return 0;var b={id:je.id++,send:v(),abort:function(){b.id={}},open:function(c,a){je[b.id]=b;qe.get(b.id,a)}};return b},oe="async",le="/",me="&",ie=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var re,se=window.localStorage;re={get:function(b){try{return se?se.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(se)return se.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var te={list:{},unbind:function(b){te.list[b]=[]},bind:function(b,c){(te.list[b]=te.list[b]||[]).push(c)},fire:function(b,c){T(te.list[b]||[],function(a){a(c)})}},ue=be("pubnub")||0,ve=function(b){b.jsonp&&(ie=0);var c=b.subscribe_key||"";b.uuid||re.get(c+"uuid");b.xdr=ne;b.db=re;b._is_online=pe;b.jsonp_cb=
ke;var a=ma(b);a.css=ge;a.$=be;a.create=he;a.bind=de;a.head=ee;a.search=ce;a.attr=fe;a.events=te;a.init=ve;if(b.notest)return a;de("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});de("offline",window,a._reset_offline);de("offline",document,a._reset_offline);return a};de("load",window,function(){V($,0)});var we=ue||{};PUBNUB=ve({notest:1,publish_key:fe(we,"pub-key"),subscribe_key:fe(we,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==fe(we,"ssl"),
origin:fe(we,"origin"),uuid:fe(we,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var qe=be("pubnubs")||0;if(ue){ge(ue,{position:"absolute",top:-J});if("opera"in window||fe(ue,"flash"))ue.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return je[b].onerror();
je[b].responseText=unescape(c);je[b].onload()};je.id=J}}
var xe=PUBNUB.ws=function(b,c){if(!(this instanceof xe))return new xe(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
xe.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var ye=PUBNUB.ws=function(b,c){if(!(this instanceof ye))return new ye(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
ye.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var ze=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++ze?ze:ze=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:ka,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),la=a.reconnect||v(),N=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,ka=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:N,m:la};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var Ae=function(b){return document.getElementById(b)},Be=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},Ce=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},De=
function(){return Be("head")[0]},Ee=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},Fe=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},Ge=function(b){return document.createElement(b)},Je=function(){return He||Ie()?0:L()},Me=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=Ae(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(He||Ie()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=Ie()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(Ke);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(Le)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);He=0;b=Me(b);break a}b=g}return b}var n=Ge("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[Ne]=Ne);n.onerror=function(){c(1)};n.src=b.url.join(Ke);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(Le)}Ee(n,"id",f);De().appendChild(n);return c},Oe=function(){return!("onLine"in
navigator)?1:navigator.onLine},Ie=function(){if(!Pe||!Pe.get)return 0;var b={id:Ie.id++,send:v(),abort:function(){b.id={}},open:function(c,a){Ie[b.id]=b;Pe.get(b.id,a)}};return b},Ne="async",Ke="/",Le="&",He=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var Qe,Re=window.localStorage;Qe={get:function(b){try{return Re?Re.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(Re)return Re.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var Se={list:{},unbind:function(b){Se.list[b]=[]},bind:function(b,c){(Se.list[b]=Se.list[b]||[]).push(c)},fire:function(b,c){T(Se.list[b]||[],function(a){a(c)})}},Te=Ae("pubnub")||0,Ue=function(b){b.jsonp&&(He=0);var c=b.subscribe_key||"";b.uuid||Qe.get(c+"uuid");b.xdr=Me;b.db=Qe;b._is_online=Oe;b.jsonp_cb=
Je;var a=ma(b);a.css=Fe;a.$=Ae;a.create=Ge;a.bind=Ce;a.head=De;a.search=Be;a.attr=Ee;a.events=Se;a.init=Ue;if(b.notest)return a;Ce("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});Ce("offline",window,a._reset_offline);Ce("offline",document,a._reset_offline);return a};Ce("load",window,function(){V($,0)});var Ve=Te||{};PUBNUB=Ue({notest:1,publish_key:Ee(Ve,"pub-key"),subscribe_key:Ee(Ve,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==Ee(Ve,"ssl"),
origin:Ee(Ve,"origin"),uuid:Ee(Ve,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var Pe=Ae("pubnubs")||0;if(Te){Fe(Te,{position:"absolute",top:-J});if("opera"in window||Ee(Te,"flash"))Te.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return Ie[b].onerror();
Ie[b].responseText=unescape(c);Ie[b].onload()};Ie.id=J}}
var We=PUBNUB.ws=function(b,c){if(!(this instanceof We))return new We(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
We.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var Xe=PUBNUB.ws=function(b,c){if(!(this instanceof Xe))return new Xe(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Xe.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var Ye=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++Ye?Ye:Ye=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:ka,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),N=a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,ka=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:ja,m:N};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();
if(!window.PUBNUB){var Ze=function(b){return document.getElementById(b)},$e=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},af=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},bf=
function(){return $e("head")[0]},cf=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},df=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},ef=function(b){return document.createElement(b)},hf=function(){return ff||gf()?0:L()},lf=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=Ze(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(ff||gf()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=gf()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(jf);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(kf)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);ff=0;b=lf(b);break a}b=g}return b}var n=ef("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[mf]=mf);n.onerror=function(){c(1)};n.src=b.url.join(jf);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(kf)}cf(n,"id",f);bf().appendChild(n);return c},nf=function(){return!("onLine"in
navigator)?1:navigator.onLine},gf=function(){if(!of||!of.get)return 0;var b={id:gf.id++,send:v(),abort:function(){b.id={}},open:function(c,a){gf[b.id]=b;of.get(b.id,a)}};return b},mf="async",jf="/",kf="&",ff=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var pf,qf=window.localStorage;pf={get:function(b){try{return qf?qf.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(qf)return qf.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var rf={list:{},unbind:function(b){rf.list[b]=[]},bind:function(b,c){(rf.list[b]=rf.list[b]||[]).push(c)},fire:function(b,c){T(rf.list[b]||[],function(a){a(c)})}},sf=Ze("pubnub")||0,tf=function(b){b.jsonp&&(ff=0);var c=b.subscribe_key||"";b.uuid||pf.get(c+"uuid");b.xdr=lf;b.db=pf;b._is_online=nf;b.jsonp_cb=
hf;var a=ma(b);a.css=df;a.$=Ze;a.create=ef;a.bind=af;a.head=bf;a.search=$e;a.attr=cf;a.events=rf;a.init=tf;if(b.notest)return a;af("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});af("offline",window,a._reset_offline);af("offline",document,a._reset_offline);return a};af("load",window,function(){V($,0)});var uf=sf||{};PUBNUB=tf({notest:1,publish_key:cf(uf,"pub-key"),subscribe_key:cf(uf,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==cf(uf,"ssl"),
origin:cf(uf,"origin"),uuid:cf(uf,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var of=Ze("pubnubs")||0;if(sf){df(sf,{position:"absolute",top:-J});if("opera"in window||cf(sf,"flash"))sf.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return gf[b].onerror();
gf[b].responseText=unescape(c);gf[b].onload()};gf.id=J}}
var vf=PUBNUB.ws=function(b,c){if(!(this instanceof vf))return new vf(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
vf.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
var wf=PUBNUB.ws=function(b,c){if(!(this instanceof wf))return new wf(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
wf.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var xf=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++xf?xf:xf=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:ka,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),N=a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,ka=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:ja,m:N};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
if(!window.PUBNUB){var yf=function(b){return document.getElementById(b)},zf=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},Af=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},Bf=
function(){return zf("head")[0]},Cf=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},Df=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},Ef=function(b){return document.createElement(b)},Hf=function(){return Ff||Gf()?0:L()},Lf=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=yf(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(Ff||Gf()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||If,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=Gf()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(Jf);if(b.data){var e=[],m,i=i+"?";for(m in b.data)e.push(m+
"="+b.data[m]);i+=e.join(Kf)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);Ff=0;b=Lf(b);break a}b=g}return b}var n=Ef("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||If),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[Mf]=Mf);n.onerror=function(){c(1)};n.src=b.url.join(Jf);if(b.data){i=[];n.src+="?";for(key in b.data)i.push(key+"="+b.data[key]);n.src+=i.join(Kf)}Cf(n,"id",f);Bf().appendChild(n);return c},Gf=function(){if(!Nf.get)return 0;var b={id:Gf.id++,
send:v(),abort:function(){b.id={}},open:function(c,a){Gf[b.id]=b;Nf.get(b.id,a)}};return b},Mf="async",Jf="/",Kf="&",If=1E4,Ff=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var Of,Pf=window.localStorage;Of={get:function(b){try{return Pf?Pf.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(Pf)return Pf.setItem(b,
c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var Qf=yf("pubnub")||{},Rf=function(b){var c=b.subscribe_key||"";b.uuid||Of.get(c+"uuid");c={xdr:Lf,db:Of,each:T,map:X,grep:S,css:Df,$:yf,create:Ef,bind:Af,supplant:U,head:Bf,search:zf,attr:Cf,now:M,unique:L,events:events,updater:R,init:Rf};b.xdr=Lf;b.db=Of;b.jsonp_cb=Hf;b.bind_leave=function(){Af("beforeunload",window,function(){each_channel(v());return q})};c.__proto__=ma(b);return c};PUBNUB=Rf({publish_key:Cf(Qf,
"pub-key"),subscribe_key:Cf(Qf,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==Cf(Qf,"ssl"),origin:Cf(Qf,"origin"),uuid:Cf(Qf,"uuid")});Df(Qf,{position:"absolute",top:-J});if("opera"in window||Cf(Qf,"flash"))Qf.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";var Nf=yf("pubnubs")||{};Af("load",window,function(){V(PUBNUB.ready(),0)});PUBNUB.rdx=
function(b,c){if(!c)return Gf[b].onerror();Gf[b].responseText=unescape(c);Gf[b].onload()};Gf.id=J;window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$()}
var Sf=PUBNUB.ws=function(b,c){if(!(this instanceof Sf))return new Sf(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Sf.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var Tf=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++Tf?Tf:Tf=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:ka,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),N=a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,ka=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:ja,m:N};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
if(!window.PUBNUB){var Uf=function(b){return document.getElementById(b)},Vf=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},Wf=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},Xf=
function(){return Vf("head")[0]},Yf=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},Zf=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},$f=function(b){return document.createElement(b)},cg=function(){return ag||bg()?0:L()},gg=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=Uf(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(ag||bg()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||dg,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=bg()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(eg);if(b.data){var e=[],m,i=i+"?";for(m in b.data)e.push(m+
"="+b.data[m]);i+=e.join(fg)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);ag=0;b=gg(b);break a}b=g}return b}var n=$f("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||dg),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[hg]=hg);n.onerror=function(){c(1)};n.src=b.url.join(eg);if(b.data){i=[];n.src+="?";for(key in b.data)i.push(key+"="+b.data[key]);n.src+=i.join(fg)}Yf(n,"id",f);Xf().appendChild(n);return c},bg=function(){if(!ig.get)return 0;var b={id:bg.id++,
send:v(),abort:function(){b.id={}},open:function(c,a){bg[b.id]=b;ig.get(b.id,a)}};return b},hg="async",eg="/",fg="&",dg=1E4,ag=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var jg,kg=window.localStorage;jg={get:function(b){try{return kg?kg.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(kg)return kg.setItem(b,
c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var lg=Uf("pubnub")||{},mg=function(b){var c=b.subscribe_key||"";b.uuid||jg.get(c+"uuid");c={xdr:gg,db:jg,each:T,map:X,grep:S,css:Zf,$:Uf,create:$f,bind:Wf,supplant:U,head:Xf,search:Vf,attr:Yf,now:M,unique:L,events:events,updater:R,init:mg};b.xdr=gg;b.db=jg;b.jsonp_cb=cg;b.bind_leave=function(){Wf("beforeunload",window,function(){each_channel(v());return q})};c.__proto__=ma(b);return c};PUBNUB=mg({publish_key:Yf(lg,
"pub-key"),subscribe_key:Yf(lg,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==Yf(lg,"ssl"),origin:Yf(lg,"origin"),uuid:Yf(lg,"uuid")});Zf(lg,{position:"absolute",top:-J});if("opera"in window||Yf(lg,"flash"))lg.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";var ig=Uf("pubnubs")||{};Wf("load",window,function(){V(PUBNUB.ready(),0)});PUBNUB.rdx=
function(b,c){if(!c)return bg[b].onerror();bg[b].responseText=unescape(c);bg[b].onload()};bg.id=J;window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$()}
var ng=PUBNUB.ws=function(b,c){if(!(this instanceof ng))return new ng(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
ng.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var og=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++og?og:og=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:ka,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),N=a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,ka=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:ja,m:N};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
if(!window.PUBNUB){var pg=function(b){return document.getElementById(b)},qg=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},rg=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},sg=
function(){return qg("head")[0]},tg=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},ug=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},vg=function(b){return document.createElement(b)},yg=function(){return wg||xg()?0:L()},Cg=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=pg(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(wg||xg()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||zg,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=xg()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(Ag);if(b.data){var e=[],m,i=i+"?";for(m in b.data)e.push(m+
"="+b.data[m]);i+=e.join(Bg)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);wg=0;b=Cg(b);break a}b=g}return b}var n=vg("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||zg),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[Dg]=Dg);n.onerror=function(){c(1)};n.src=b.url.join(Ag);if(b.data){i=[];n.src+="?";for(key in b.data)i.push(key+"="+b.data[key]);n.src+=i.join(Bg)}tg(n,"id",f);sg().appendChild(n);return c},xg=function(){if(!Eg.get)return 0;var b={id:xg.id++,
send:v(),abort:function(){b.id={}},open:function(c,a){xg[b.id]=b;Eg.get(b.id,a)}};return b},Dg="async",Ag="/",Bg="&",zg=1E4,wg=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var Fg,Gg=window.localStorage;Fg={get:function(b){try{return Gg?Gg.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(Gg)return Gg.setItem(b,
c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var Hg=pg("pubnub")||{},Ig=function(b){var c=b.subscribe_key||"";b.uuid||Fg.get(c+"uuid");c={xdr:Cg,db:Fg,each:T,map:X,grep:S,css:ug,$:pg,create:vg,bind:rg,supplant:U,head:sg,search:qg,attr:tg,now:M,unique:L,events:events,updater:R,init:Ig};b.xdr=Cg;b.db=Fg;b.jsonp_cb=yg;b.bind_leave=function(){rg("beforeunload",window,function(){each_channel(v());return q})};c.__proto__=ma(b);return c};PUBNUB=Ig({publish_key:tg(Hg,
"pub-key"),subscribe_key:tg(Hg,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==tg(Hg,"ssl"),origin:tg(Hg,"origin"),uuid:tg(Hg,"uuid")});ug(Hg,{position:"absolute",top:-J});if("opera"in window||tg(Hg,"flash"))Hg.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";var Eg=pg("pubnubs")||{};rg("load",window,function(){V(PUBNUB.ready(),0)});PUBNUB.rdx=
function(b,c){if(!c)return xg[b].onerror();xg[b].responseText=unescape(c);xg[b].onload()};xg.id=J;window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$()}
var Jg=PUBNUB.ws=function(b,c){if(!(this instanceof Jg))return new Jg(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
Jg.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
window.JSON&&window.JSON.stringify||function(){function b(){try{return this.valueOf()}catch(a){return t}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=w[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(d,r){var h,g,i,m,j,n=e,f=r[d];f&&"object"===typeof f&&(f=b.call(f));"function"===typeof l&&(f=l.call(r,d,f));switch(typeof f){case "string":return c(f);case "number":return isFinite(f)?String(f):"null";case "boolean":case "null":return String(f);
case "object":if(!f)return"null";e+=k;j=[];if("[object Array]"===Object.prototype.toString.apply(f)){m=f.length;for(h=0;h<m;h+=1)j[h]=a(h,f)||"null";i=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+n+"]":"["+j.join(",")+"]";e=n;return i}if(l&&"object"===typeof l){m=l.length;for(h=0;h<m;h+=1)g=l[h],"string"===typeof g&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i)}else for(g in f)Object.hasOwnProperty.call(f,g)&&(i=a(g,f))&&j.push(c(g)+(e?": ":":")+i);i=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+
n+"}":"{"+j.join(",")+"}";e=n;return i}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,k,w={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,d){var g;k=e="";if("number"===typeof d)for(g=0;g<d;g+=1)k+=" ";else"string"===typeof d&&(k=d);(l=c)&&("function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))&&aa(Error("JSON.stringify"));return a("",{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();ba=1;A=u;E=[];H="-pnpres";ca=10;I=1E4;da=310;ea=60;J=1E3;fa=/{([\w\-]+)}/g;function L(){return"x"+ ++ba+""+ +new Date}function M(){return+new Date}var Kg=Math.floor(20*Math.random());O=function(b,c){return 0<b.indexOf("pubsub.")&&b.replace("pubsub","ps"+(c?P().split("-")[0]:20>++Kg?Kg:Kg=1))||b};
function R(b,c){function a(){e+c>M()?(clearTimeout(d),d=setTimeout(a,c)):(e=M(),b())}var d,e=0;return a}function S(b,c){var a=[];T(b||[],function(b){c(b)&&a.push(b)});return a}function U(b,c){return b.replace(fa,function(a,b){return c[b]||a})}function V(b,c){return setTimeout(b,c)}function P(b){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});b&&b(c);return c}
function T(b,c){if(b&&c)if("undefined"!=typeof b[0])for(var a=0,d=b.length;a<d;)c.call(b[a],b[a],a++);else for(a in b)b.hasOwnProperty&&b.hasOwnProperty(a)&&c.call(b[a],a,b[a])}function X(b,c){var a=[];T(b||[],function(b,e){a.push(c(b,e))});return a}function Y(b){return X(encodeURIComponent(b).split(""),function(b){return 0>"-_.!~*'()".indexOf(b)?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function Z(b){var c=[];T(b,function(a,b){b.h&&c.push(a)});return c.sort()}
function $(){V(function(){A||(A=1,T(E,function(b){b()}))},J)}
function ma(b){function c(){}function a(a){a&&(m.j=0);!m.j&&m.length&&(m.j=1,y(m.shift()))}function d(a){T(Z(x),function(b){(b=x[b])&&a(b)})}var e=+b.windowing||ca,k=(+b.timeout||da)*J,w=(+b.keepalive||ea)*J,l=b.publish_key||"",p=b.subscribe_key||"",r=b.ssl?"s":"",h="http"+r+"://"+(b.origin||"pubsub.pubnub.com"),g=O(h),i=O(h),m=[],j=0,n=0,f=0,D=0,K=0,B=0,x={},y=b.xdr,N=b._is_online||z(1),C=b.jsonp_cb||z(0),F=b.db||{get:v(),set:v()},G=b.uuid||F&&F.get(p+"uuid")||"",s={_reset_offline:function(){f&&
f(1)},LEAVE:function(a,b){var c={uuid:G},d=O(h),e=C();0<a.indexOf(H)||("0"!=e&&(c.callback=e),y({i:b||r,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",p,"channel",Y(a),"leave"]}))},history:function(a,b){var b=a.callback||b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||v(),f=a.channel,h=a.start,i=a.end,j={},k=C();if(!f)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");j.stringtoken="true";j.count=c;j.reverse=d;k&&(j.callback=
k);h&&(j.start=h);i&&(j.end=i);y({a:k,data:j,d:function(a){b(a)},c:e,url:[g,"v2","history","sub-key",p,"channel",Y(f)]})},replay:function(a){var b=b||a.callback||v(),c=a.source,d=a.destination,e=a.stop,f=a.start,h=a.end,i=a.reverse,a=a.limit,j=C(),k={};if(!c)return error("Missing Source Channel");if(!d)return error("Missing Destination Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");"0"!=j&&(k.callback=j);e&&(k.stop="all");i&&(k.reverse="true");f&&(k.start=
f);h&&(k.end=h);a&&(k.count=a);y({a:j,d:function(a){b(a)},c:function(){b([0,"Disconnected"])},url:[g,"v1","replay",l,p,c,d],data:k})},time:function(a){var b=C();y({a:b,timeout:5*J,url:[g,"time",b],d:function(b){a(b[0])},c:function(){a(0)}})},publish:function(b,c){var c=c||b.callback||v(),d=b.message,e=b.channel,f=C();if(!d)return error("Missing Message");if(!e)return error("Missing Channel");if(!l)return error("Missing Publish Key");if(!p)return error("Missing Subscribe Key");d=JSON.stringify(d);
e=[g,"publish",l,p,0,Y(e),f,Y(d)];m.push({a:f,timeout:5*J,url:e,data:{uuid:G},d:function(b){c(b);a(1)},c:function(){c([0,"Failed",d]);a(1)}});a()},unsubscribe:function(a){a=a.channel;B=0;D=1;a=X((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+H}).join(",");T(a.split(","),function(a){A&&s.LEAVE(a,0);x[a]=0});A&&c()},subscribe:function(a,b){function l(a){a?V(m,J):(g=O(h,1),i=O(h,1),V(function(){s.time(l)},J));d(function(b){if(a&&b.e)return b.e=0,b.m(b.name);!a&&!b.e&&(b.e=1,b.l(b.name))})}
function m(){var a=C(),b=Z(x).join(",");b&&(f=y({timeout:ka,a:a,c:function(){s.time(l)},data:{uuid:G},url:[i,"subscribe",p,Y(b),a,B],d:function(a){if(!a)return V(m,ia);d(function(a){a.g||(a.g=1,a.k(a.name))});B=!B&&D&&F.get(p)||a[1];W&&(Timetoken=1E4,W=0);F.set(p,a[1]);var b,c=(2<a.length?a[2]:"").split(",");b=function(){var a=c.shift()||"";return[(x[a]||{}).a||j,(a||n).split(H)[0]]};T(a[0],function(c){var d=b();if(x[d[1]].h)d[0](c,a,d[1])});V(m,ia)}}))}var r=a.channel,b=(b=b||a.callback)||a.message,
w=a.connect||v(),N=a.reconnect||v(),ja=a.disconnect||v(),Q=a.presence||0,ga=a.noheresync||0,W=a.backfill||0,ka=a.timeout||k,ia=a.windowing||e;a.restore&&(D=1);B=0;if(!r)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");T((r.join?r.join(","):""+r).split(","),function(a){var c=x[a]||{};x[n=a]={name:a,g:c.g,e:c.e,h:1,a:j=b,k:w,l:ja,m:N};Q&&(s.subscribe({channel:a+H,callback:Q}),!c.h&&!ga&&s.here_now({channel:a,callback:function(b){T("uuids"in
b?b.uuids:[],function(c){Q({action:"join",uuid:c,timestamp:M(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s._reset_offline();clearTimeout(K);K=V(m,100)};if(!A)return E.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||v(),d=a.channel,e=C(),f=t;if(!d)return error("Missing Channel");if(!b)return error("Missing Callback");if(!p)return error("Missing Subscribe Key");"0"!=e&&(f={},f.callback=e);y({a:e,data:f,d:function(a){b(a)},c:c,url:[g,"v2","presence","sub_key",p,"channel",
Y(d)]})},xdr:y,ready:$,db:F,uuid:P,each:T,map:X,grep:S,supplant:U,now:M,unique:L,updater:R,poll_online:function(){N()||s._reset_offline();V(s.poll_online,J)},poll_online2:function(){s.time(function(a){a||s._reset_offline();V(s.poll_online2,w)})}};G||(G=s.uuid());F.set(p+"uuid",G);V(s.poll_online,J);V(s.poll_online2,w);return s}
if(!window.PUBNUB){var Lg=function(b){return document.getElementById(b)},Mg=function(b,c){var a=[];T(b.split(/\s+/),function(b){T((c||document).getElementsByTagName(b),function(b){a.push(b)})});return a},Ng=function(b,c,a){T(b.split(","),function(b){function e(b){b||(b=window.event);a(b)||(b.cancelBubble=q,b.returnValue=u,b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())}c.addEventListener?c.addEventListener(b,e,u):c.attachEvent?c.attachEvent("on"+b,e):c["on"+b]=e})},Og=
function(){return Mg("head")[0]},Pg=function(b,c,a){if(a)b.setAttribute(c,a);else return b&&b.getAttribute&&b.getAttribute(c)},Qg=function(b,c){for(var a in c)if(c.hasOwnProperty(a))try{b.style[a]=c[a]+(0<"|width|height|top|left|".indexOf(a)&&"number"==typeof c[a]?"px":"")}catch(d){}},Rg=function(b){return document.createElement(b)},Ug=function(){return Sg||Tg()?0:L()},Xg=function(b){function c(a,b){D||(D=1,a||x(b),n.onerror=t,clearTimeout(K),V(function(){a&&B();var b=Lg(f),c=b&&b.parentNode;c&&c.removeChild(b)},
J))}if(Sg||Tg()){a:{var a,d,e=function(){if(!w){w=1;clearTimeout(p);try{d=JSON.parse(a.responseText)}catch(b){return g(1)}h(d)}},k=0,w=0,l=b.timeout||I,p=V(function(){g(1)},l),r=b.c||v(),h=b.d||v(),g=function(b){k||(k=1,clearTimeout(p),a&&(a.onerror=a.onload=t,a.abort&&a.abort(),a=t),b&&r())};try{a=Tg()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;a.onerror=a.onabort=function(){g(1)};a.onload=a.onloadend=e;a.timeout=l;var i=b.url.join(Vg);if(b.data){var e=[],m;console.log(b.data);
i+="?";for(m in b.data)e.push(m+"="+b.data[m]);i+=e.join(Wg)}a.open("GET",i,typeof("undefined"===b.i));a.send()}catch(j){g(0);Sg=0;b=Xg(b);break a}b=g}return b}var n=Rg("script"),i=b.a,f=L(),D=0,K=V(function(){c(1)},b.timeout||I),B=b.c||v(),x=b.d||v();window[i]=function(a){c(0,a)};b.i||(n[Yg]=Yg);n.onerror=function(){c(1)};n.src=b.url.join(Vg);if(b.data){i=[];n.src+="?";for(e in b.data)i.push(e+"="+b.data[e]);n.src+=i.join(Wg)}Pg(n,"id",f);Og().appendChild(n);return c},Zg=function(){return!("onLine"in
navigator)?1:navigator.onLine},Tg=function(){if(!$g||!$g.get)return 0;var b={id:Tg.id++,send:v(),abort:function(){b.id={}},open:function(c,a){Tg[b.id]=b;$g.get(b.id,a)}};return b},Yg="async",Vg="/",Wg="&",Sg=-1==navigator.userAgent.indexOf("MSIE 6");window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||v());var ah,bh=window.localStorage;ah={get:function(b){try{return bh?bh.getItem(b):-1==document.cookie.indexOf(b)?t:((document.cookie||
"").match(RegExp(b+"=([^;]+)"))||[])[1]||t}catch(c){}},set:function(b,c){try{if(bh)return bh.setItem(b,c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(a){}}};var ch={list:{},unbind:function(b){ch.list[b]=[]},bind:function(b,c){(ch.list[b]=ch.list[b]||[]).push(c)},fire:function(b,c){T(ch.list[b]||[],function(a){a(c)})}},dh=Lg("pubnub")||0,eh=function(b){b.jsonp&&(Sg=0);var c=b.subscribe_key||"";b.uuid||ah.get(c+"uuid");b.xdr=Xg;b.db=ah;b._is_online=Zg;b.jsonp_cb=
Ug;var a=ma(b);a.css=Qg;a.$=Lg;a.create=Rg;a.bind=Ng;a.head=Og;a.search=Mg;a.attr=Pg;a.events=ch;a.init=eh;if(b.notest)return a;Ng("beforeunload",window,function(){each_channel(function(b){a.LEAVE(b.name,1)});return q});Ng("offline",window,a._reset_offline);Ng("offline",document,a._reset_offline);return a};Ng("load",window,function(){V($,0)});var fh=dh||{};PUBNUB=eh({notest:1,publish_key:Pg(fh,"pub-key"),subscribe_key:Pg(fh,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==Pg(fh,"ssl"),
origin:Pg(fh,"origin"),uuid:Pg(fh,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&$();var $g=Lg("pubnubs")||0;if(dh){Qg(dh,{position:"absolute",top:-J});if("opera"in window||Pg(dh,"flash"))dh.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(b,c){if(!c)return Tg[b].onerror();
Tg[b].responseText=unescape(c);Tg[b].onload()};Tg.id=J}}
var gh=PUBNUB.ws=function(b,c){if(!(this instanceof gh))return new gh(b,c);var a=this,b=a.url=b||"";a.protocol=c||"Sec-WebSocket-Protocol";var d=b.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=a.onsend=
v();a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=u;a.buffer=[];a.readyState=a.CONNECTING;if(!b)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:q}),a;a.b=PUBNUB.init(d);a.b.f=d;a.f=d;a.b.subscribe({restore:u,channel:d.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:u})},callback:function(b){a.onmessage({data:b})},connect:function(){a.readyState=a.OPEN;a.onopen()}})};
gh.prototype.send=function(b){var c=this;c.b.publish({channel:c.b.f.channel,message:b,callback:function(a){c.onsend({data:a})}})};
})();
PUBNUB['crypto'] = (function(){
    var Nr = 14,
    /* Default to 256 Bit Encryption */
    Nk = 8,
    Decrypt = false,

    enc_utf8 = function(s)
    {
        try {
            return unescape(encodeURIComponent(s));
        }
        catch(e) {
            throw 'Error on UTF-8 encode';
        }
    },

    dec_utf8 = function(s)
    {
        try {
            return decodeURIComponent(escape(s));
        }
        catch(e) {
            throw ('Bad Key');
        }
    },

    padBlock = function(byteArr)
    {
        var array = [], cpad, i;
        if (byteArr.length < 16) {
            cpad = 16 - byteArr.length;
            array = [cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad, cpad];
        }
        for (i = 0; i < byteArr.length; i++)
        {
            array[i] = byteArr[i];
        }
        return array;
    },

    block2s = function(block, lastBlock)
    {
        var string = '', padding, i;
        if (lastBlock) {
            padding = block[15];
            if (padding > 16) {
                throw ('Decryption error: Maybe bad key');
            }
            if (padding == 16) {
                return '';
            }
            for (i = 0; i < 16 - padding; i++) {
                string += String.fromCharCode(block[i]);
            }
        } else {
            for (i = 0; i < 16; i++) {
                string += String.fromCharCode(block[i]);
            }
        }
        return string;
    },

    a2h = function(numArr)
    {
        var string = '', i;
        for (i = 0; i < numArr.length; i++) {
            string += (numArr[i] < 16 ? '0': '') + numArr[i].toString(16);
        }
        return string;
    },

    h2a = function(s)
    {
        var ret = [];
        s.replace(/(..)/g,
        function(s) {
            ret.push(parseInt(s, 16));
        });
        return ret;
    },

    s2a = function(string, binary) {
        var array = [], i;

        if (! binary) {
            string = enc_utf8(string);
        }

        for (i = 0; i < string.length; i++)
        {
            array[i] = string.charCodeAt(i);
        }

        return array;
    },

    size = function(newsize)
    {
        switch (newsize)
        {
        case 128:
            Nr = 10;
            Nk = 4;
            break;
        case 192:
            Nr = 12;
            Nk = 6;
            break;
        case 256:
            Nr = 14;
            Nk = 8;
            break;
        default:
            throw ('Invalid Key Size Specified:' + newsize);
        }
    },

    randArr = function(num) {
        var result = [], i;
        for (i = 0; i < num; i++) {
            result = result.concat(Math.floor(Math.random() * 256));
        }
        return result;
    },

    openSSLKey = function(passwordArr, saltArr) {
        // Number of rounds depends on the size of the AES in use
        // 3 rounds for 256
        //        2 rounds for the key, 1 for the IV
        // 2 rounds for 128
        //        1 round for the key, 1 round for the IV
        // 3 rounds for 192 since it's not evenly divided by 128 bits
        var rounds = Nr >= 12 ? 3: 2,
        key = [],
        iv = [],
        md5_hash = [],
        result = [],
        data00 = passwordArr.concat(saltArr),
        i;
        md5_hash[0] = GibberishAES.Hash.MD5(data00);
        result = md5_hash[0];
        for (i = 1; i < rounds; i++) {
            md5_hash[i] = GibberishAES.Hash.MD5(md5_hash[i - 1].concat(data00));
            result = result.concat(md5_hash[i]);
        }
        key = result.slice(0, 4 * Nk);
        iv = result.slice(4 * Nk, 4 * Nk + 16);
        return {
            key: key,
            iv: iv
        };
    },

    rawEncrypt = function(plaintext, key, iv) {
        // plaintext, key and iv as byte arrays
        key = expandKey(key);
        var numBlocks = Math.ceil(plaintext.length / 16),
        blocks = [],
        i,
        cipherBlocks = [];
        for (i = 0; i < numBlocks; i++) {
            blocks[i] = padBlock(plaintext.slice(i * 16, i * 16 + 16));
        }
        if (plaintext.length % 16 === 0) {
            blocks.push([16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]);
            // CBC OpenSSL padding scheme
            numBlocks++;
        }
        for (i = 0; i < blocks.length; i++) {
            blocks[i] = (i === 0) ? xorBlocks(blocks[i], iv) : xorBlocks(blocks[i], cipherBlocks[i - 1]);
            cipherBlocks[i] = encryptBlock(blocks[i], key);
        }
        return cipherBlocks;
    },

    rawDecrypt = function(cryptArr, key, iv, binary) {
        //  cryptArr, key and iv as byte arrays
        key = expandKey(key);
        var numBlocks = cryptArr.length / 16,
        cipherBlocks = [],
        i,
        plainBlocks = [],
        string = '';
        for (i = 0; i < numBlocks; i++) {
            cipherBlocks.push(cryptArr.slice(i * 16, (i + 1) * 16));
        }
        for (i = cipherBlocks.length - 1; i >= 0; i--) {
            plainBlocks[i] = decryptBlock(cipherBlocks[i], key);
            plainBlocks[i] = (i === 0) ? xorBlocks(plainBlocks[i], iv) : xorBlocks(plainBlocks[i], cipherBlocks[i - 1]);
        }
        for (i = 0; i < numBlocks - 1; i++) {
            string += block2s(plainBlocks[i]);
        }
        string += block2s(plainBlocks[i], true);
        return binary ? string : dec_utf8(string); 
    },

    encryptBlock = function(block, words) {
        Decrypt = false;
        var state = addRoundKey(block, words, 0),
        round;
        for (round = 1; round < (Nr + 1); round++) {
            state = subBytes(state);
            state = shiftRows(state);
            if (round < Nr) {
                state = mixColumns(state);
            }
            //last round? don't mixColumns
            state = addRoundKey(state, words, round);
        }

        return state;
    },

    decryptBlock = function(block, words) {
        Decrypt = true;
        var state = addRoundKey(block, words, Nr),
        round;
        for (round = Nr - 1; round > -1; round--) {
            state = shiftRows(state);
            state = subBytes(state);
            state = addRoundKey(state, words, round);
            if (round > 0) {
                state = mixColumns(state);
            }
            //last round? don't mixColumns
        }

        return state;
    },

    subBytes = function(state) {
        var S = Decrypt ? SBoxInv: SBox,
        temp = [],
        i;
        for (i = 0; i < 16; i++) {
            temp[i] = S[state[i]];
        }
        return temp;
    },

    shiftRows = function(state) {
        var temp = [],
        shiftBy = Decrypt ? [0, 13, 10, 7, 4, 1, 14, 11, 8, 5, 2, 15, 12, 9, 6, 3] : [0, 5, 10, 15, 4, 9, 14, 3, 8, 13, 2, 7, 12, 1, 6, 11],
        i;
        for (i = 0; i < 16; i++) {
            temp[i] = state[shiftBy[i]];
        }
        return temp;
    },

    mixColumns = function(state) {
        var t = [],
        c;
        if (!Decrypt) {
            for (c = 0; c < 4; c++) {
                t[c * 4] = G2X[state[c * 4]] ^ G3X[state[1 + c * 4]] ^ state[2 + c * 4] ^ state[3 + c * 4];
                t[1 + c * 4] = state[c * 4] ^ G2X[state[1 + c * 4]] ^ G3X[state[2 + c * 4]] ^ state[3 + c * 4];
                t[2 + c * 4] = state[c * 4] ^ state[1 + c * 4] ^ G2X[state[2 + c * 4]] ^ G3X[state[3 + c * 4]];
                t[3 + c * 4] = G3X[state[c * 4]] ^ state[1 + c * 4] ^ state[2 + c * 4] ^ G2X[state[3 + c * 4]];
            }
        }else {
            for (c = 0; c < 4; c++) {
                t[c*4] = GEX[state[c*4]] ^ GBX[state[1+c*4]] ^ GDX[state[2+c*4]] ^ G9X[state[3+c*4]];
                t[1+c*4] = G9X[state[c*4]] ^ GEX[state[1+c*4]] ^ GBX[state[2+c*4]] ^ GDX[state[3+c*4]];
                t[2+c*4] = GDX[state[c*4]] ^ G9X[state[1+c*4]] ^ GEX[state[2+c*4]] ^ GBX[state[3+c*4]];
                t[3+c*4] = GBX[state[c*4]] ^ GDX[state[1+c*4]] ^ G9X[state[2+c*4]] ^ GEX[state[3+c*4]];
            }
        }
        
        return t;
    },

    addRoundKey = function(state, words, round) {
        var temp = [],
        i;
        for (i = 0; i < 16; i++) {
            temp[i] = state[i] ^ words[round][i];
        }
        return temp;
    },

    xorBlocks = function(block1, block2) {
        var temp = [],
        i;
        for (i = 0; i < 16; i++) {
            temp[i] = block1[i] ^ block2[i];
        }
        return temp;
    },

    expandKey = function(key) {
        // Expects a 1d number array
        var w = [],
        temp = [],
        i,
        r,
        t,
        flat = [],
        j;

        for (i = 0; i < Nk; i++) {
            r = [key[4 * i], key[4 * i + 1], key[4 * i + 2], key[4 * i + 3]];
            w[i] = r;
        }

        for (i = Nk; i < (4 * (Nr + 1)); i++) {
            w[i] = [];
            for (t = 0; t < 4; t++) {
                temp[t] = w[i - 1][t];
            }
            if (i % Nk === 0) {
                temp = subWord(rotWord(temp));
                temp[0] ^= Rcon[i / Nk - 1];
            } else if (Nk > 6 && i % Nk == 4) {
                temp = subWord(temp);
            }
            for (t = 0; t < 4; t++) {
                w[i][t] = w[i - Nk][t] ^ temp[t];
            }
        }
        for (i = 0; i < (Nr + 1); i++) {
            flat[i] = [];
            for (j = 0; j < 4; j++) {
                flat[i].push(w[i * 4 + j][0], w[i * 4 + j][1], w[i * 4 + j][2], w[i * 4 + j][3]);
            }
        }
        return flat;
    },

    subWord = function(w) {
        // apply SBox to 4-byte word w
        for (var i = 0; i < 4; i++) {
            w[i] = SBox[w[i]];
        }
        return w;
    },

    rotWord = function(w) {
        // rotate 4-byte word w left by one byte
        var tmp = w[0],
        i;
        for (i = 0; i < 4; i++) {
            w[i] = w[i + 1];
        }
        w[3] = tmp;
        return w;
    },

// jlcooke: 2012-07-12: added strhex + invertArr to compress G2X/G3X/G9X/GBX/GEX/SBox/SBoxInv/Rcon saving over 7KB, and added encString, decString
    strhex = function(str,size) {
        var ret = [];
        for (i=0; i<str.length; i+=size)
            ret[i/size] = parseInt(str.substr(i,size), 16);
        return ret;
    },
    invertArr = function(arr) {
        var ret = [];
        for (i=0; i<arr.length; i++)
            ret[arr[i]] = i;
        return ret;
    },
    Gxx = function(a, b) {
        var i, ret;

        ret = 0;
        for (i=0; i<8; i++) {
            ret = ((b&1)==1) ? ret^a : ret;
            /* xmult */
            a = (a>0x7f) ? 0x11b^(a<<1) : (a<<1);
            b >>>= 1;
        }

        return ret;
    },
    Gx = function(x) {
        var r = [];
        for (var i=0; i<256; i++)
            r[i] = Gxx(x, i);
        return r;
    },

    // S-box
/*
    SBox = [
    99, 124, 119, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171,
    118, 202, 130, 201, 125, 250, 89, 71, 240, 173, 212, 162, 175, 156, 164,
    114, 192, 183, 253, 147, 38, 54, 63, 247, 204, 52, 165, 229, 241, 113,
    216, 49, 21, 4, 199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226,
    235, 39, 178, 117, 9, 131, 44, 26, 27, 110, 90, 160, 82, 59, 214,
    179, 41, 227, 47, 132, 83, 209, 0, 237, 32, 252, 177, 91, 106, 203,
    190, 57, 74, 76, 88, 207, 208, 239, 170, 251, 67, 77, 51, 133, 69,
    249, 2, 127, 80, 60, 159, 168, 81, 163, 64, 143, 146, 157, 56, 245,
    188, 182, 218, 33, 16, 255, 243, 210, 205, 12, 19, 236, 95, 151, 68,
    23, 196, 167, 126, 61, 100, 93, 25, 115, 96, 129, 79, 220, 34, 42,
    144, 136, 70, 238, 184, 20, 222, 94, 11, 219, 224, 50, 58, 10, 73,
    6, 36, 92, 194, 211, 172, 98, 145, 149, 228, 121, 231, 200, 55, 109,
    141, 213, 78, 169, 108, 86, 244, 234, 101, 122, 174, 8, 186, 120, 37,
    46, 28, 166, 180, 198, 232, 221, 116, 31, 75, 189, 139, 138, 112, 62,
    181, 102, 72, 3, 246, 14, 97, 53, 87, 185, 134, 193, 29, 158, 225,
    248, 152, 17, 105, 217, 142, 148, 155, 30, 135, 233, 206, 85, 40, 223,
    140, 161, 137, 13, 191, 230, 66, 104, 65, 153, 45, 15, 176, 84, 187,
    22], //*/ SBox = strhex('637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16',2),

    // Precomputed lookup table for the inverse SBox
/*    SBoxInv = [
    82, 9, 106, 213, 48, 54, 165, 56, 191, 64, 163, 158, 129, 243, 215,
    251, 124, 227, 57, 130, 155, 47, 255, 135, 52, 142, 67, 68, 196, 222,
    233, 203, 84, 123, 148, 50, 166, 194, 35, 61, 238, 76, 149, 11, 66,
    250, 195, 78, 8, 46, 161, 102, 40, 217, 36, 178, 118, 91, 162, 73,
    109, 139, 209, 37, 114, 248, 246, 100, 134, 104, 152, 22, 212, 164, 92,
    204, 93, 101, 182, 146, 108, 112, 72, 80, 253, 237, 185, 218, 94, 21,
    70, 87, 167, 141, 157, 132, 144, 216, 171, 0, 140, 188, 211, 10, 247,
    228, 88, 5, 184, 179, 69, 6, 208, 44, 30, 143, 202, 63, 15, 2,
    193, 175, 189, 3, 1, 19, 138, 107, 58, 145, 17, 65, 79, 103, 220,
    234, 151, 242, 207, 206, 240, 180, 230, 115, 150, 172, 116, 34, 231, 173,
    53, 133, 226, 249, 55, 232, 28, 117, 223, 110, 71, 241, 26, 113, 29,
    41, 197, 137, 111, 183, 98, 14, 170, 24, 190, 27, 252, 86, 62, 75,
    198, 210, 121, 32, 154, 219, 192, 254, 120, 205, 90, 244, 31, 221, 168,
    51, 136, 7, 199, 49, 177, 18, 16, 89, 39, 128, 236, 95, 96, 81,
    127, 169, 25, 181, 74, 13, 45, 229, 122, 159, 147, 201, 156, 239, 160,
    224, 59, 77, 174, 42, 245, 176, 200, 235, 187, 60, 131, 83, 153, 97,
    23, 43, 4, 126, 186, 119, 214, 38, 225, 105, 20, 99, 85, 33, 12,
    125], //*/ SBoxInv = invertArr(SBox),

    // Rijndael Rcon
/*
    Rcon = [1, 2, 4, 8, 16, 32, 64, 128, 27, 54, 108, 216, 171, 77, 154, 47, 94,
    188, 99, 198, 151, 53, 106, 212, 179, 125, 250, 239, 197, 145],
//*/ Rcon = strhex('01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591',2),

/*
    G2X = [
    0x00, 0x02, 0x04, 0x06, 0x08, 0x0a, 0x0c, 0x0e, 0x10, 0x12, 0x14, 0x16,
    0x18, 0x1a, 0x1c, 0x1e, 0x20, 0x22, 0x24, 0x26, 0x28, 0x2a, 0x2c, 0x2e,
    0x30, 0x32, 0x34, 0x36, 0x38, 0x3a, 0x3c, 0x3e, 0x40, 0x42, 0x44, 0x46,
    0x48, 0x4a, 0x4c, 0x4e, 0x50, 0x52, 0x54, 0x56, 0x58, 0x5a, 0x5c, 0x5e,
    0x60, 0x62, 0x64, 0x66, 0x68, 0x6a, 0x6c, 0x6e, 0x70, 0x72, 0x74, 0x76,
    0x78, 0x7a, 0x7c, 0x7e, 0x80, 0x82, 0x84, 0x86, 0x88, 0x8a, 0x8c, 0x8e,
    0x90, 0x92, 0x94, 0x96, 0x98, 0x9a, 0x9c, 0x9e, 0xa0, 0xa2, 0xa4, 0xa6,
    0xa8, 0xaa, 0xac, 0xae, 0xb0, 0xb2, 0xb4, 0xb6, 0xb8, 0xba, 0xbc, 0xbe,
    0xc0, 0xc2, 0xc4, 0xc6, 0xc8, 0xca, 0xcc, 0xce, 0xd0, 0xd2, 0xd4, 0xd6,
    0xd8, 0xda, 0xdc, 0xde, 0xe0, 0xe2, 0xe4, 0xe6, 0xe8, 0xea, 0xec, 0xee,
    0xf0, 0xf2, 0xf4, 0xf6, 0xf8, 0xfa, 0xfc, 0xfe, 0x1b, 0x19, 0x1f, 0x1d,
    0x13, 0x11, 0x17, 0x15, 0x0b, 0x09, 0x0f, 0x0d, 0x03, 0x01, 0x07, 0x05,
    0x3b, 0x39, 0x3f, 0x3d, 0x33, 0x31, 0x37, 0x35, 0x2b, 0x29, 0x2f, 0x2d,
    0x23, 0x21, 0x27, 0x25, 0x5b, 0x59, 0x5f, 0x5d, 0x53, 0x51, 0x57, 0x55,
    0x4b, 0x49, 0x4f, 0x4d, 0x43, 0x41, 0x47, 0x45, 0x7b, 0x79, 0x7f, 0x7d,
    0x73, 0x71, 0x77, 0x75, 0x6b, 0x69, 0x6f, 0x6d, 0x63, 0x61, 0x67, 0x65,
    0x9b, 0x99, 0x9f, 0x9d, 0x93, 0x91, 0x97, 0x95, 0x8b, 0x89, 0x8f, 0x8d,
    0x83, 0x81, 0x87, 0x85, 0xbb, 0xb9, 0xbf, 0xbd, 0xb3, 0xb1, 0xb7, 0xb5,
    0xab, 0xa9, 0xaf, 0xad, 0xa3, 0xa1, 0xa7, 0xa5, 0xdb, 0xd9, 0xdf, 0xdd,
    0xd3, 0xd1, 0xd7, 0xd5, 0xcb, 0xc9, 0xcf, 0xcd, 0xc3, 0xc1, 0xc7, 0xc5,
    0xfb, 0xf9, 0xff, 0xfd, 0xf3, 0xf1, 0xf7, 0xf5, 0xeb, 0xe9, 0xef, 0xed,
    0xe3, 0xe1, 0xe7, 0xe5
    ], //*/ G2X = Gx(2),

/*    G3X = [
    0x00, 0x03, 0x06, 0x05, 0x0c, 0x0f, 0x0a, 0x09, 0x18, 0x1b, 0x1e, 0x1d,
    0x14, 0x17, 0x12, 0x11, 0x30, 0x33, 0x36, 0x35, 0x3c, 0x3f, 0x3a, 0x39,
    0x28, 0x2b, 0x2e, 0x2d, 0x24, 0x27, 0x22, 0x21, 0x60, 0x63, 0x66, 0x65,
    0x6c, 0x6f, 0x6a, 0x69, 0x78, 0x7b, 0x7e, 0x7d, 0x74, 0x77, 0x72, 0x71,
    0x50, 0x53, 0x56, 0x55, 0x5c, 0x5f, 0x5a, 0x59, 0x48, 0x4b, 0x4e, 0x4d,
    0x44, 0x47, 0x42, 0x41, 0xc0, 0xc3, 0xc6, 0xc5, 0xcc, 0xcf, 0xca, 0xc9,
    0xd8, 0xdb, 0xde, 0xdd, 0xd4, 0xd7, 0xd2, 0xd1, 0xf0, 0xf3, 0xf6, 0xf5,
    0xfc, 0xff, 0xfa, 0xf9, 0xe8, 0xeb, 0xee, 0xed, 0xe4, 0xe7, 0xe2, 0xe1,
    0xa0, 0xa3, 0xa6, 0xa5, 0xac, 0xaf, 0xaa, 0xa9, 0xb8, 0xbb, 0xbe, 0xbd,
    0xb4, 0xb7, 0xb2, 0xb1, 0x90, 0x93, 0x96, 0x95, 0x9c, 0x9f, 0x9a, 0x99,
    0x88, 0x8b, 0x8e, 0x8d, 0x84, 0x87, 0x82, 0x81, 0x9b, 0x98, 0x9d, 0x9e,
    0x97, 0x94, 0x91, 0x92, 0x83, 0x80, 0x85, 0x86, 0x8f, 0x8c, 0x89, 0x8a,
    0xab, 0xa8, 0xad, 0xae, 0xa7, 0xa4, 0xa1, 0xa2, 0xb3, 0xb0, 0xb5, 0xb6,
    0xbf, 0xbc, 0xb9, 0xba, 0xfb, 0xf8, 0xfd, 0xfe, 0xf7, 0xf4, 0xf1, 0xf2,
    0xe3, 0xe0, 0xe5, 0xe6, 0xef, 0xec, 0xe9, 0xea, 0xcb, 0xc8, 0xcd, 0xce,
    0xc7, 0xc4, 0xc1, 0xc2, 0xd3, 0xd0, 0xd5, 0xd6, 0xdf, 0xdc, 0xd9, 0xda,
    0x5b, 0x58, 0x5d, 0x5e, 0x57, 0x54, 0x51, 0x52, 0x43, 0x40, 0x45, 0x46,
    0x4f, 0x4c, 0x49, 0x4a, 0x6b, 0x68, 0x6d, 0x6e, 0x67, 0x64, 0x61, 0x62,
    0x73, 0x70, 0x75, 0x76, 0x7f, 0x7c, 0x79, 0x7a, 0x3b, 0x38, 0x3d, 0x3e,
    0x37, 0x34, 0x31, 0x32, 0x23, 0x20, 0x25, 0x26, 0x2f, 0x2c, 0x29, 0x2a,
    0x0b, 0x08, 0x0d, 0x0e, 0x07, 0x04, 0x01, 0x02, 0x13, 0x10, 0x15, 0x16,
    0x1f, 0x1c, 0x19, 0x1a
    ], //*/ G3X = Gx(3),

/*
    G9X = [
    0x00, 0x09, 0x12, 0x1b, 0x24, 0x2d, 0x36, 0x3f, 0x48, 0x41, 0x5a, 0x53,
    0x6c, 0x65, 0x7e, 0x77, 0x90, 0x99, 0x82, 0x8b, 0xb4, 0xbd, 0xa6, 0xaf,
    0xd8, 0xd1, 0xca, 0xc3, 0xfc, 0xf5, 0xee, 0xe7, 0x3b, 0x32, 0x29, 0x20,
    0x1f, 0x16, 0x0d, 0x04, 0x73, 0x7a, 0x61, 0x68, 0x57, 0x5e, 0x45, 0x4c,
    0xab, 0xa2, 0xb9, 0xb0, 0x8f, 0x86, 0x9d, 0x94, 0xe3, 0xea, 0xf1, 0xf8,
    0xc7, 0xce, 0xd5, 0xdc, 0x76, 0x7f, 0x64, 0x6d, 0x52, 0x5b, 0x40, 0x49,
    0x3e, 0x37, 0x2c, 0x25, 0x1a, 0x13, 0x08, 0x01, 0xe6, 0xef, 0xf4, 0xfd,
    0xc2, 0xcb, 0xd0, 0xd9, 0xae, 0xa7, 0xbc, 0xb5, 0x8a, 0x83, 0x98, 0x91,
    0x4d, 0x44, 0x5f, 0x56, 0x69, 0x60, 0x7b, 0x72, 0x05, 0x0c, 0x17, 0x1e,
    0x21, 0x28, 0x33, 0x3a, 0xdd, 0xd4, 0xcf, 0xc6, 0xf9, 0xf0, 0xeb, 0xe2,
    0x95, 0x9c, 0x87, 0x8e, 0xb1, 0xb8, 0xa3, 0xaa, 0xec, 0xe5, 0xfe, 0xf7,
    0xc8, 0xc1, 0xda, 0xd3, 0xa4, 0xad, 0xb6, 0xbf, 0x80, 0x89, 0x92, 0x9b,
    0x7c, 0x75, 0x6e, 0x67, 0x58, 0x51, 0x4a, 0x43, 0x34, 0x3d, 0x26, 0x2f,
    0x10, 0x19, 0x02, 0x0b, 0xd7, 0xde, 0xc5, 0xcc, 0xf3, 0xfa, 0xe1, 0xe8,
    0x9f, 0x96, 0x8d, 0x84, 0xbb, 0xb2, 0xa9, 0xa0, 0x47, 0x4e, 0x55, 0x5c,
    0x63, 0x6a, 0x71, 0x78, 0x0f, 0x06, 0x1d, 0x14, 0x2b, 0x22, 0x39, 0x30,
    0x9a, 0x93, 0x88, 0x81, 0xbe, 0xb7, 0xac, 0xa5, 0xd2, 0xdb, 0xc0, 0xc9,
    0xf6, 0xff, 0xe4, 0xed, 0x0a, 0x03, 0x18, 0x11, 0x2e, 0x27, 0x3c, 0x35,
    0x42, 0x4b, 0x50, 0x59, 0x66, 0x6f, 0x74, 0x7d, 0xa1, 0xa8, 0xb3, 0xba,
    0x85, 0x8c, 0x97, 0x9e, 0xe9, 0xe0, 0xfb, 0xf2, 0xcd, 0xc4, 0xdf, 0xd6,
    0x31, 0x38, 0x23, 0x2a, 0x15, 0x1c, 0x07, 0x0e, 0x79, 0x70, 0x6b, 0x62,
    0x5d, 0x54, 0x4f, 0x46
    ], //*/ G9X = Gx(9),

/*    GBX = [
    0x00, 0x0b, 0x16, 0x1d, 0x2c, 0x27, 0x3a, 0x31, 0x58, 0x53, 0x4e, 0x45,
    0x74, 0x7f, 0x62, 0x69, 0xb0, 0xbb, 0xa6, 0xad, 0x9c, 0x97, 0x8a, 0x81,
    0xe8, 0xe3, 0xfe, 0xf5, 0xc4, 0xcf, 0xd2, 0xd9, 0x7b, 0x70, 0x6d, 0x66,
    0x57, 0x5c, 0x41, 0x4a, 0x23, 0x28, 0x35, 0x3e, 0x0f, 0x04, 0x19, 0x12,
    0xcb, 0xc0, 0xdd, 0xd6, 0xe7, 0xec, 0xf1, 0xfa, 0x93, 0x98, 0x85, 0x8e,
    0xbf, 0xb4, 0xa9, 0xa2, 0xf6, 0xfd, 0xe0, 0xeb, 0xda, 0xd1, 0xcc, 0xc7,
    0xae, 0xa5, 0xb8, 0xb3, 0x82, 0x89, 0x94, 0x9f, 0x46, 0x4d, 0x50, 0x5b,
    0x6a, 0x61, 0x7c, 0x77, 0x1e, 0x15, 0x08, 0x03, 0x32, 0x39, 0x24, 0x2f,
    0x8d, 0x86, 0x9b, 0x90, 0xa1, 0xaa, 0xb7, 0xbc, 0xd5, 0xde, 0xc3, 0xc8,
    0xf9, 0xf2, 0xef, 0xe4, 0x3d, 0x36, 0x2b, 0x20, 0x11, 0x1a, 0x07, 0x0c,
    0x65, 0x6e, 0x73, 0x78, 0x49, 0x42, 0x5f, 0x54, 0xf7, 0xfc, 0xe1, 0xea,
    0xdb, 0xd0, 0xcd, 0xc6, 0xaf, 0xa4, 0xb9, 0xb2, 0x83, 0x88, 0x95, 0x9e,
    0x47, 0x4c, 0x51, 0x5a, 0x6b, 0x60, 0x7d, 0x76, 0x1f, 0x14, 0x09, 0x02,
    0x33, 0x38, 0x25, 0x2e, 0x8c, 0x87, 0x9a, 0x91, 0xa0, 0xab, 0xb6, 0xbd,
    0xd4, 0xdf, 0xc2, 0xc9, 0xf8, 0xf3, 0xee, 0xe5, 0x3c, 0x37, 0x2a, 0x21,
    0x10, 0x1b, 0x06, 0x0d, 0x64, 0x6f, 0x72, 0x79, 0x48, 0x43, 0x5e, 0x55,
    0x01, 0x0a, 0x17, 0x1c, 0x2d, 0x26, 0x3b, 0x30, 0x59, 0x52, 0x4f, 0x44,
    0x75, 0x7e, 0x63, 0x68, 0xb1, 0xba, 0xa7, 0xac, 0x9d, 0x96, 0x8b, 0x80,
    0xe9, 0xe2, 0xff, 0xf4, 0xc5, 0xce, 0xd3, 0xd8, 0x7a, 0x71, 0x6c, 0x67,
    0x56, 0x5d, 0x40, 0x4b, 0x22, 0x29, 0x34, 0x3f, 0x0e, 0x05, 0x18, 0x13,
    0xca, 0xc1, 0xdc, 0xd7, 0xe6, 0xed, 0xf0, 0xfb, 0x92, 0x99, 0x84, 0x8f,
    0xbe, 0xb5, 0xa8, 0xa3
    ], //*/ GBX = Gx(0xb),

/*
    GDX = [
    0x00, 0x0d, 0x1a, 0x17, 0x34, 0x39, 0x2e, 0x23, 0x68, 0x65, 0x72, 0x7f,
    0x5c, 0x51, 0x46, 0x4b, 0xd0, 0xdd, 0xca, 0xc7, 0xe4, 0xe9, 0xfe, 0xf3,
    0xb8, 0xb5, 0xa2, 0xaf, 0x8c, 0x81, 0x96, 0x9b, 0xbb, 0xb6, 0xa1, 0xac,
    0x8f, 0x82, 0x95, 0x98, 0xd3, 0xde, 0xc9, 0xc4, 0xe7, 0xea, 0xfd, 0xf0,
    0x6b, 0x66, 0x71, 0x7c, 0x5f, 0x52, 0x45, 0x48, 0x03, 0x0e, 0x19, 0x14,
    0x37, 0x3a, 0x2d, 0x20, 0x6d, 0x60, 0x77, 0x7a, 0x59, 0x54, 0x43, 0x4e,
    0x05, 0x08, 0x1f, 0x12, 0x31, 0x3c, 0x2b, 0x26, 0xbd, 0xb0, 0xa7, 0xaa,
    0x89, 0x84, 0x93, 0x9e, 0xd5, 0xd8, 0xcf, 0xc2, 0xe1, 0xec, 0xfb, 0xf6,
    0xd6, 0xdb, 0xcc, 0xc1, 0xe2, 0xef, 0xf8, 0xf5, 0xbe, 0xb3, 0xa4, 0xa9,
    0x8a, 0x87, 0x90, 0x9d, 0x06, 0x0b, 0x1c, 0x11, 0x32, 0x3f, 0x28, 0x25,
    0x6e, 0x63, 0x74, 0x79, 0x5a, 0x57, 0x40, 0x4d, 0xda, 0xd7, 0xc0, 0xcd,
    0xee, 0xe3, 0xf4, 0xf9, 0xb2, 0xbf, 0xa8, 0xa5, 0x86, 0x8b, 0x9c, 0x91,
    0x0a, 0x07, 0x10, 0x1d, 0x3e, 0x33, 0x24, 0x29, 0x62, 0x6f, 0x78, 0x75,
    0x56, 0x5b, 0x4c, 0x41, 0x61, 0x6c, 0x7b, 0x76, 0x55, 0x58, 0x4f, 0x42,
    0x09, 0x04, 0x13, 0x1e, 0x3d, 0x30, 0x27, 0x2a, 0xb1, 0xbc, 0xab, 0xa6,
    0x85, 0x88, 0x9f, 0x92, 0xd9, 0xd4, 0xc3, 0xce, 0xed, 0xe0, 0xf7, 0xfa,
    0xb7, 0xba, 0xad, 0xa0, 0x83, 0x8e, 0x99, 0x94, 0xdf, 0xd2, 0xc5, 0xc8,
    0xeb, 0xe6, 0xf1, 0xfc, 0x67, 0x6a, 0x7d, 0x70, 0x53, 0x5e, 0x49, 0x44,
    0x0f, 0x02, 0x15, 0x18, 0x3b, 0x36, 0x21, 0x2c, 0x0c, 0x01, 0x16, 0x1b,
    0x38, 0x35, 0x22, 0x2f, 0x64, 0x69, 0x7e, 0x73, 0x50, 0x5d, 0x4a, 0x47,
    0xdc, 0xd1, 0xc6, 0xcb, 0xe8, 0xe5, 0xf2, 0xff, 0xb4, 0xb9, 0xae, 0xa3,
    0x80, 0x8d, 0x9a, 0x97
    ], //*/ GDX = Gx(0xd),

/*
    GEX = [
    0x00, 0x0e, 0x1c, 0x12, 0x38, 0x36, 0x24, 0x2a, 0x70, 0x7e, 0x6c, 0x62,
    0x48, 0x46, 0x54, 0x5a, 0xe0, 0xee, 0xfc, 0xf2, 0xd8, 0xd6, 0xc4, 0xca,
    0x90, 0x9e, 0x8c, 0x82, 0xa8, 0xa6, 0xb4, 0xba, 0xdb, 0xd5, 0xc7, 0xc9,
    0xe3, 0xed, 0xff, 0xf1, 0xab, 0xa5, 0xb7, 0xb9, 0x93, 0x9d, 0x8f, 0x81,
    0x3b, 0x35, 0x27, 0x29, 0x03, 0x0d, 0x1f, 0x11, 0x4b, 0x45, 0x57, 0x59,
    0x73, 0x7d, 0x6f, 0x61, 0xad, 0xa3, 0xb1, 0xbf, 0x95, 0x9b, 0x89, 0x87,
    0xdd, 0xd3, 0xc1, 0xcf, 0xe5, 0xeb, 0xf9, 0xf7, 0x4d, 0x43, 0x51, 0x5f,
    0x75, 0x7b, 0x69, 0x67, 0x3d, 0x33, 0x21, 0x2f, 0x05, 0x0b, 0x19, 0x17,
    0x76, 0x78, 0x6a, 0x64, 0x4e, 0x40, 0x52, 0x5c, 0x06, 0x08, 0x1a, 0x14,
    0x3e, 0x30, 0x22, 0x2c, 0x96, 0x98, 0x8a, 0x84, 0xae, 0xa0, 0xb2, 0xbc,
    0xe6, 0xe8, 0xfa, 0xf4, 0xde, 0xd0, 0xc2, 0xcc, 0x41, 0x4f, 0x5d, 0x53,
    0x79, 0x77, 0x65, 0x6b, 0x31, 0x3f, 0x2d, 0x23, 0x09, 0x07, 0x15, 0x1b,
    0xa1, 0xaf, 0xbd, 0xb3, 0x99, 0x97, 0x85, 0x8b, 0xd1, 0xdf, 0xcd, 0xc3,
    0xe9, 0xe7, 0xf5, 0xfb, 0x9a, 0x94, 0x86, 0x88, 0xa2, 0xac, 0xbe, 0xb0,
    0xea, 0xe4, 0xf6, 0xf8, 0xd2, 0xdc, 0xce, 0xc0, 0x7a, 0x74, 0x66, 0x68,
    0x42, 0x4c, 0x5e, 0x50, 0x0a, 0x04, 0x16, 0x18, 0x32, 0x3c, 0x2e, 0x20,
    0xec, 0xe2, 0xf0, 0xfe, 0xd4, 0xda, 0xc8, 0xc6, 0x9c, 0x92, 0x80, 0x8e,
    0xa4, 0xaa, 0xb8, 0xb6, 0x0c, 0x02, 0x10, 0x1e, 0x34, 0x3a, 0x28, 0x26,
    0x7c, 0x72, 0x60, 0x6e, 0x44, 0x4a, 0x58, 0x56, 0x37, 0x39, 0x2b, 0x25,
    0x0f, 0x01, 0x13, 0x1d, 0x47, 0x49, 0x5b, 0x55, 0x7f, 0x71, 0x63, 0x6d,
    0xd7, 0xd9, 0xcb, 0xc5, 0xef, 0xe1, 0xf3, 0xfd, 0xa7, 0xa9, 0xbb, 0xb5,
    0x9f, 0x91, 0x83, 0x8d
    ], //*/ GEX = Gx(0xe),

    enc = function(string, pass, binary) {
        // string, password in plaintext
        var salt = randArr(8),
        pbe = openSSLKey(s2a(pass, binary), salt),
        key = pbe.key,
        iv = pbe.iv,
        cipherBlocks,
        saltBlock = [[83, 97, 108, 116, 101, 100, 95, 95].concat(salt)];
        string = s2a(string, binary);
        cipherBlocks = rawEncrypt(string, key, iv);
        // Spells out 'Salted__'
        cipherBlocks = saltBlock.concat(cipherBlocks);
        return Base64.encode(cipherBlocks);
    },

    dec = function(string, pass, binary) {
        // string, password in plaintext
        var cryptArr = Base64.decode(string),
        salt = cryptArr.slice(8, 16),
        pbe = openSSLKey(s2a(pass, binary), salt),
        key = pbe.key,
        iv = pbe.iv;
        cryptArr = cryptArr.slice(16, cryptArr.length);
        // Take off the Salted__ffeeddcc
        string = rawDecrypt(cryptArr, key, iv, binary);
        return string;
    },
    
    MD5 = function(numArr) {

        function rotateLeft(lValue, iShiftBits) {
            return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits));
        }

        function addUnsigned(lX, lY) {
            var lX4,
            lY4,
            lX8,
            lY8,
            lResult;
            lX8 = (lX & 0x80000000);
            lY8 = (lY & 0x80000000);
            lX4 = (lX & 0x40000000);
            lY4 = (lY & 0x40000000);
            lResult = (lX & 0x3FFFFFFF) + (lY & 0x3FFFFFFF);
            if (lX4 & lY4) {
                return (lResult ^ 0x80000000 ^ lX8 ^ lY8);
            }
            if (lX4 | lY4) {
                if (lResult & 0x40000000) {
                    return (lResult ^ 0xC0000000 ^ lX8 ^ lY8);
                } else {
                    return (lResult ^ 0x40000000 ^ lX8 ^ lY8);
                }
            } else {
                return (lResult ^ lX8 ^ lY8);
            }
        }

        function f(x, y, z) {
            return (x & y) | ((~x) & z);
        }
        function g(x, y, z) {
            return (x & z) | (y & (~z));
        }
        function h(x, y, z) {
            return (x ^ y ^ z);
        }
        function funcI(x, y, z) {
            return (y ^ (x | (~z)));
        }

        function ff(a, b, c, d, x, s, ac) {
            a = addUnsigned(a, addUnsigned(addUnsigned(f(b, c, d), x), ac));
            return addUnsigned(rotateLeft(a, s), b);
        }

        function gg(a, b, c, d, x, s, ac) {
            a = addUnsigned(a, addUnsigned(addUnsigned(g(b, c, d), x), ac));
            return addUnsigned(rotateLeft(a, s), b);
        }

        function hh(a, b, c, d, x, s, ac) {
            a = addUnsigned(a, addUnsigned(addUnsigned(h(b, c, d), x), ac));
            return addUnsigned(rotateLeft(a, s), b);
        }

        function ii(a, b, c, d, x, s, ac) {
            a = addUnsigned(a, addUnsigned(addUnsigned(funcI(b, c, d), x), ac));
            return addUnsigned(rotateLeft(a, s), b);
        }

        function convertToWordArray(numArr) {
            var lWordCount,
            lMessageLength = numArr.length,
            lNumberOfWords_temp1 = lMessageLength + 8,
            lNumberOfWords_temp2 = (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64,
            lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16,
            lWordArray = [],
            lBytePosition = 0,
            lByteCount = 0;
            while (lByteCount < lMessageLength) {
                lWordCount = (lByteCount - (lByteCount % 4)) / 4;
                lBytePosition = (lByteCount % 4) * 8;
                lWordArray[lWordCount] = (lWordArray[lWordCount] | (numArr[lByteCount] << lBytePosition));
                lByteCount++;
            }
            lWordCount = (lByteCount - (lByteCount % 4)) / 4;
            lBytePosition = (lByteCount % 4) * 8;
            lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80 << lBytePosition);
            lWordArray[lNumberOfWords - 2] = lMessageLength << 3;
            lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;
            return lWordArray;
        }

        function wordToHex(lValue) {
            var lByte,
            lCount,
            wordToHexArr = [];
            for (lCount = 0; lCount <= 3; lCount++) {
                lByte = (lValue >>> (lCount * 8)) & 255;
                wordToHexArr = wordToHexArr.concat(lByte);
             }
            return wordToHexArr;
        }

        /*function utf8Encode(string) {
            string = string.replace(/\r\n/g, "\n");
            var utftext = "",
            n,
            c;

            for (n = 0; n < string.length; n++) {

                c = string.charCodeAt(n);

                if (c < 128) {
                    utftext += String.fromCharCode(c);
                }
                else if ((c > 127) && (c < 2048)) {
                    utftext += String.fromCharCode((c >> 6) | 192);
                    utftext += String.fromCharCode((c & 63) | 128);
                }
                else {
                    utftext += String.fromCharCode((c >> 12) | 224);
                    utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                    utftext += String.fromCharCode((c & 63) | 128);
                }

            }

            return utftext;
        }*/

        var x = [],
        k,
        AA,
        BB,
        CC,
        DD,
        a,
        b,
        c,
        d,
        rnd = strhex('67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391',8);

        x = convertToWordArray(numArr);

        a = rnd[0];
        b = rnd[1];
        c = rnd[2];
        d = rnd[3]

        for (k = 0; k < x.length; k += 16) {
            AA = a;
            BB = b;
            CC = c;
            DD = d;
            a = ff(a, b, c, d, x[k + 0], 7, rnd[4]);
            d = ff(d, a, b, c, x[k + 1], 12, rnd[5]);
            c = ff(c, d, a, b, x[k + 2], 17, rnd[6]);
            b = ff(b, c, d, a, x[k + 3], 22, rnd[7]);
            a = ff(a, b, c, d, x[k + 4], 7, rnd[8]);
            d = ff(d, a, b, c, x[k + 5], 12, rnd[9]);
            c = ff(c, d, a, b, x[k + 6], 17, rnd[10]);
            b = ff(b, c, d, a, x[k + 7], 22, rnd[11]);
            a = ff(a, b, c, d, x[k + 8], 7, rnd[12]);
            d = ff(d, a, b, c, x[k + 9], 12, rnd[13]);
            c = ff(c, d, a, b, x[k + 10], 17, rnd[14]);
            b = ff(b, c, d, a, x[k + 11], 22, rnd[15]);
            a = ff(a, b, c, d, x[k + 12], 7, rnd[16]);
            d = ff(d, a, b, c, x[k + 13], 12, rnd[17]);
            c = ff(c, d, a, b, x[k + 14], 17, rnd[18]);
            b = ff(b, c, d, a, x[k + 15], 22, rnd[19]);
            a = gg(a, b, c, d, x[k + 1], 5, rnd[20]);
            d = gg(d, a, b, c, x[k + 6], 9, rnd[21]);
            c = gg(c, d, a, b, x[k + 11], 14, rnd[22]);
            b = gg(b, c, d, a, x[k + 0], 20, rnd[23]);
            a = gg(a, b, c, d, x[k + 5], 5, rnd[24]);
            d = gg(d, a, b, c, x[k + 10], 9, rnd[25]);
            c = gg(c, d, a, b, x[k + 15], 14, rnd[26]);
            b = gg(b, c, d, a, x[k + 4], 20, rnd[27]);
            a = gg(a, b, c, d, x[k + 9], 5, rnd[28]);
            d = gg(d, a, b, c, x[k + 14], 9, rnd[29]);
            c = gg(c, d, a, b, x[k + 3], 14, rnd[30]);
            b = gg(b, c, d, a, x[k + 8], 20, rnd[31]);
            a = gg(a, b, c, d, x[k + 13], 5, rnd[32]);
            d = gg(d, a, b, c, x[k + 2], 9, rnd[33]);
            c = gg(c, d, a, b, x[k + 7], 14, rnd[34]);
            b = gg(b, c, d, a, x[k + 12], 20, rnd[35]);
            a = hh(a, b, c, d, x[k + 5], 4, rnd[36]);
            d = hh(d, a, b, c, x[k + 8], 11, rnd[37]);
            c = hh(c, d, a, b, x[k + 11], 16, rnd[38]);
            b = hh(b, c, d, a, x[k + 14], 23, rnd[39]);
            a = hh(a, b, c, d, x[k + 1], 4, rnd[40]);
            d = hh(d, a, b, c, x[k + 4], 11, rnd[41]);
            c = hh(c, d, a, b, x[k + 7], 16, rnd[42]);
            b = hh(b, c, d, a, x[k + 10], 23, rnd[43]);
            a = hh(a, b, c, d, x[k + 13], 4, rnd[44]);
            d = hh(d, a, b, c, x[k + 0], 11, rnd[45]);
            c = hh(c, d, a, b, x[k + 3], 16, rnd[46]);
            b = hh(b, c, d, a, x[k + 6], 23, rnd[47]);
            a = hh(a, b, c, d, x[k + 9], 4, rnd[48]);
            d = hh(d, a, b, c, x[k + 12], 11, rnd[49]);
            c = hh(c, d, a, b, x[k + 15], 16, rnd[50]);
            b = hh(b, c, d, a, x[k + 2], 23, rnd[51]);
            a = ii(a, b, c, d, x[k + 0], 6, rnd[52]);
            d = ii(d, a, b, c, x[k + 7], 10, rnd[53]);
            c = ii(c, d, a, b, x[k + 14], 15, rnd[54]);
            b = ii(b, c, d, a, x[k + 5], 21, rnd[55]);
            a = ii(a, b, c, d, x[k + 12], 6, rnd[56]);
            d = ii(d, a, b, c, x[k + 3], 10, rnd[57]);
            c = ii(c, d, a, b, x[k + 10], 15, rnd[58]);
            b = ii(b, c, d, a, x[k + 1], 21, rnd[59]);
            a = ii(a, b, c, d, x[k + 8], 6, rnd[60]);
            d = ii(d, a, b, c, x[k + 15], 10, rnd[61]);
            c = ii(c, d, a, b, x[k + 6], 15, rnd[62]);
            b = ii(b, c, d, a, x[k + 13], 21, rnd[63]);
            a = ii(a, b, c, d, x[k + 4], 6, rnd[64]);
            d = ii(d, a, b, c, x[k + 11], 10, rnd[65]);
            c = ii(c, d, a, b, x[k + 2], 15, rnd[66]);
            b = ii(b, c, d, a, x[k + 9], 21, rnd[67]);
            a = addUnsigned(a, AA);
            b = addUnsigned(b, BB);
            c = addUnsigned(c, CC);
            d = addUnsigned(d, DD);
        }

        return wordToHex(a).concat(wordToHex(b), wordToHex(c), wordToHex(d));
    },

    encString = function(plaintext, key, iv) {
        plaintext = s2a(plaintext);

        key = s2a(key);
        for (var i=key.length; i<32; i++)
            key[i] = 0;

        if (iv == null) {
            iv = genIV();
        } else {
            iv = s2a(iv);
            for (var i=iv.length; i<16; i++)
                iv[i] = 0;
        }

        var ct = rawEncrypt(plaintext, key, iv);
        var ret = [iv];
        for (var i=0; i<ct.length; i++)
            ret[ret.length] = ct[i];
        return Base64.encode(ret);
    },

    decString = function(ciphertext, key) {
        var tmp = Base64.decode(ciphertext);
        var iv = tmp.slice(0, 16);
        var ct = tmp.slice(16, tmp.length);

        key = s2a(key);
        for (var i=key.length; i<32; i++)
            key[i] = 0;

        var pt = rawDecrypt(ct, key, iv, false);
        return pt;
    },

    Base64 = (function(){
        // Takes a Nx16x1 byte array and converts it to Base64
        var _chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',
        chars = _chars.split(''),
        
        encode = function(b, withBreaks) {
            var flatArr = [],
            b64 = '',
            i,
            broken_b64;
            totalChunks = Math.floor(b.length * 16 / 3);
            for (i = 0; i < b.length * 16; i++) {
                flatArr.push(b[Math.floor(i / 16)][i % 16]);
            }
            for (i = 0; i < flatArr.length; i = i + 3) {
                b64 += chars[flatArr[i] >> 2];
                b64 += chars[((flatArr[i] & 3) << 4) | (flatArr[i + 1] >> 4)];
                if (! (flatArr[i + 1] === undefined)) {
                    b64 += chars[((flatArr[i + 1] & 15) << 2) | (flatArr[i + 2] >> 6)];
                } else {
                    b64 += '=';
                }
                if (! (flatArr[i + 2] === undefined)) {
                    b64 += chars[flatArr[i + 2] & 63];
                } else {
                    b64 += '=';
                }
            }
            // OpenSSL is super particular about line breaks
            broken_b64 = b64.slice(0, 64); // + '\n';
            for (i = 1; i < (Math.ceil(b64.length / 64)); i++) {
                broken_b64 += b64.slice(i * 64, i * 64 + 64) + (Math.ceil(b64.length / 64) == i + 1 ? '': '\n');
            }
            return broken_b64;
        },
        
        decode = function(string) {
            string = string.replace(/\n/g, '');
            var flatArr = [],
            c = [],
            b = [],
            i;
            for (i = 0; i < string.length; i = i + 4) {
                c[0] = _chars.indexOf(string.charAt(i));
                c[1] = _chars.indexOf(string.charAt(i + 1));
                c[2] = _chars.indexOf(string.charAt(i + 2));
                c[3] = _chars.indexOf(string.charAt(i + 3));

                b[0] = (c[0] << 2) | (c[1] >> 4);
                b[1] = ((c[1] & 15) << 4) | (c[2] >> 2);
                b[2] = ((c[2] & 3) << 6) | c[3];
                flatArr.push(b[0], b[1], b[2]);
            }
            flatArr = flatArr.slice(0, flatArr.length - (flatArr.length % 16));
            return flatArr;
        };
        
        //internet explorer
        if(typeof Array.indexOf === "function") {
            _chars = chars;
        }
        
        /*
        //other way to solve internet explorer problem
        if(!Array.indexOf){
            Array.prototype.indexOf = function(obj){
                for(var i=0; i<this.length; i++){
                    if(this[i]===obj){
                        return i;
                    }
                }
                return -1;
            }
        }
        */
        
        
        return {
            "encode": encode,
            "decode": decode
        };
    })();

    return {
        "size": size,
        "h2a":h2a,
        "expandKey":expandKey,
        "encryptBlock":encryptBlock,
        "decryptBlock":decryptBlock,
        "Decrypt":Decrypt,
        "s2a":s2a,
        "rawEncrypt":rawEncrypt,
        "rawDecrypt":rawDecrypt,
        "dec":dec,
        "openSSLKey":openSSLKey,
        "a2h":a2h,
        "enc":enc,
        "Hash":{"MD5":MD5},
        "Base64":Base64
    };

})();
PUBNUB['secure'] = (function(){
    var crypto = PUBNUB['crypto'];
    crypto.size(256);

    var cipher_key = "";
    var iv = crypto.s2a("0123456789012345");

    function encrypt(data) {
        var hex_message = crypto.s2a(JSON.stringify(data));
        var encryptedHexArray = crypto.rawEncrypt(hex_message, cipher_key, iv);
        var base_64_encrypted = crypto.Base64.encode(encryptedHexArray);
        return base_64_encrypted || data.data.message;
    }

    function decrypt(data, options) {
        options = options ? options : {};

        try {
            var binary_enc = crypto.Base64.decode(data);
            var json_plain = crypto.rawDecrypt(binary_enc, cipher_key, iv, false);
            var plaintext = JSON.parse(json_plain);

            return plaintext;
        }
        catch (e) {
            return options.parse_error || null;
        }
    }

    return function (setup) {
        cipher_key = crypto.s2a(SHA256(setup.cipher_key).slice(0,32));
        var pubnub = PUBNUB.init(setup);
        return {
            raw_encrypt : encrypt,
            raw_decrypt : decrypt,
            time        : PUBNUB.time,
            publish     : function (args) {
                args.message = encrypt(args.message);
                return pubnub.publish(args);
            },
            subscribe   : function (args) {
                var callback = args.callback || args.message;
                args.callback = function (message, envelope, channel) {
                    var decrypted = decrypt(message);
                    decrypted && callback(decrypted, envelope, channel);
                }
                return pubnub.subscribe(args);
            },
            history     : function (args) {
                var encrypted_messages = "";
                var old_callback = args.callback;

                function new_callback(response) {
                    encrypted_messages     = response[0];
                    var decrypted_messages = [];

                    for (a = 0; a < encrypted_messages.length; a++) {
                        var new_message = decrypt( encrypted_messages[a], {
                            "parse_error":"DECRYPT_ERROR"
                        } );
                        decrypted_messages.push((new_message));
                    }

                    old_callback([
                        decrypted_messages,
                        response[1],
                        response[2]
                    ]);
                }

                args.callback = new_callback;
                pubnub.history(args);
                return true;
            }
        };
    };
})();

function SHA256(s) {

    var chrsz = 8;
    var hexcase = 0;

    function safe_add(x, y) {
        var lsw = (x & 0xFFFF) + (y & 0xFFFF);
        var msw = (x >> 16) + (y >> 16) + (lsw >> 16);
        return (msw << 16) | (lsw & 0xFFFF);
    }

    function S(X, n) {
        return ( X >>> n ) | (X << (32 - n));
    }

    function R(X, n) {
        return ( X >>> n );
    }

    function Ch(x, y, z) {
        return ((x & y) ^ ((~x) & z));
    }

    function Maj(x, y, z) {
        return ((x & y) ^ (x & z) ^ (y & z));
    }

    function Sigma0256(x) {
        return (S(x, 2) ^ S(x, 13) ^ S(x, 22));
    }

    function Sigma1256(x) {
        return (S(x, 6) ^ S(x, 11) ^ S(x, 25));
    }

    function Gamma0256(x) {
        return (S(x, 7) ^ S(x, 18) ^ R(x, 3));
    }

    function Gamma1256(x) {
        return (S(x, 17) ^ S(x, 19) ^ R(x, 10));
    }

    function core_sha256(m, l) {
        var K = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2);
        var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);
        var W = new Array(64);
        var a, b, c, d, e, f, g, h, i, j;
        var T1, T2;

        m[l >> 5] |= 0x80 << (24 - l % 32);
        m[((l + 64 >> 9) << 4) + 15] = l;

        for (var i = 0; i < m.length; i += 16) {
            a = HASH[0];
            b = HASH[1];
            c = HASH[2];
            d = HASH[3];
            e = HASH[4];
            f = HASH[5];
            g = HASH[6];
            h = HASH[7];

            for (var j = 0; j < 64; j++) {
                if (j < 16) W[j] = m[j + i];
                else W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);

                T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);
                T2 = safe_add(Sigma0256(a), Maj(a, b, c));

                h = g;
                g = f;
                f = e;
                e = safe_add(d, T1);
                d = c;
                c = b;
                b = a;
                a = safe_add(T1, T2);
            }

            HASH[0] = safe_add(a, HASH[0]);
            HASH[1] = safe_add(b, HASH[1]);
            HASH[2] = safe_add(c, HASH[2]);
            HASH[3] = safe_add(d, HASH[3]);
            HASH[4] = safe_add(e, HASH[4]);
            HASH[5] = safe_add(f, HASH[5]);
            HASH[6] = safe_add(g, HASH[6]);
            HASH[7] = safe_add(h, HASH[7]);
        }
        return HASH;
    }

    function str2binb(str) {
        var bin = Array();
        var mask = (1 << chrsz) - 1;
        for (var i = 0; i < str.length * chrsz; i += chrsz) {
            bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << (24 - i % 32);
        }
        return bin;
    }

    function Utf8Encode(string) {
        string = string.replace(/\r\n/g, "\n");
        var utftext = "";

        for (var n = 0; n < string.length; n++) {

            var c = string.charCodeAt(n);

            if (c < 128) {
                utftext += String.fromCharCode(c);
            }
            else if ((c > 127) && (c < 2048)) {
                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            }
            else {
                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }

        }

        return utftext;
    }

    function binb2hex(binarray) {
        var hex_tab = hexcase ? "0123456789ABCDEF" : "0123456789abcdef";
        var str = "";
        for (var i = 0; i < binarray.length * 4; i++) {
            str += hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8 + 4)) & 0xF) +
                hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8  )) & 0xF);
        }
        return str;
    }

    s = Utf8Encode(s);
    return binb2hex(core_sha256(str2binb(s), s.length * chrsz));
}
(function(){function n(c){b.each(d,function(a){if(a in g&&c in g[a]){var e=g[a][c];e.connected&&(e.connected=!1,e.socket.user_count--,b.events.fire(a+"leave",e))}})}function l(c,a,e,h,d){var k=j(a);b.publish({channel:k.channel,message:{name:c,ns:a,data:e,uuid:m,geo:k.location||[0,0]},callback:function(b){if(b[0])return(d||function(){})(b);var i=2*(h||500);setTimeout(function(){l(c,a,e,i,d)},5500<i?5500:i)}})}function p(c){c=c||function(){};navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(b){socket.location=
[b.coords.latitude,b.coords.longitude];c(socket.location)})||c([0,0])}function j(c){var a=d[c]||(d[c]={namespace:c,connected:!1,users:g[c]={},user_count:1,get_user_list:function(){return d[c].users},get_user_count:function(){return d[c].user_count},emit:function(b,a,d){l(b,c,a,0,d)},send:function(b,a){l("message",c,b,0,a)},on:function(a,d){"string"===typeof a?b.events.bind(c+a,d):"object"===typeof a&&b.each(a,function(a){b.events.bind(c+a,d)})},disconnect:function(){b.unsubscribe({channel:a.channel})},
history:function(a,d){var g=j(c);a.channel=g.channel;b.history(a,function(a){var b=[];PUBNUB.each(a[0]||[],function(a){"message"==a.name&&a.ns==c&&b.push(a)});a[0]=b;d(a)})},here_now:function(a){var d=j(c);b.here_now({channel:d.channel},a)}});return a}var b=PUBNUB,q=0,m=PUBNUB.db.get("uuid")||b.uuid(function(b){PUBNUB.db.set("uuid",m=b)}),d={},g={},r=window.io={connected:{},connect:function(c,a){function e(){var a=b.map(d,function(a){return a});l("ping",i,{nss:a,cuser:s})}var h=(c+"////").split("/"),
a=a||{},s=a.user||{},k="presence"in a?a.presence:!0,t=h[2],i=(h[3]||"standard")+"-"+a.channel,h=a.channel,f=j(i);f.channel=h;f.password="GibberishAES"in window&&a.password;if(h in r.connected)return f;a.geo&&setInterval(p,15E3)&&p();a.uuid=m;a.origin=t;b=r.connected[h]=q?b:PUBNUB[f.password?"secure":"init"](a);q=1;f.disconnected=0;b.subscribe({channel:f.channel,disconnect:function(){f.disconnected||(f.disconnected=1,b.each(d,function(a){b.events.fire(a+"disconnect",{})}))},reconnect:function(){b.disconnected=
0},connect:function(){f.disconnected=0;b.each(d,function(a){var c=j(a);c.connected||(c.connected=!0,b.events.fire(a+"connect",{}))});e()},presence:k&&function(a){"leave"===a.action&&n(a.uuid);"timeout"===a.action&&n(a.uuid);"join"===a.action&&e()},callback:function(a){f.disconnected&&b.each(d,function(a){b.events.fire(a+"reconnect",{})});f.disconnected=0;var c=a.data;a.ns in d&&c&&b.events.fire(a.ns+a.name,c);a.uuid&&a.uuid!==m&&"ping"===a.name&&b.each(c.nss,function(d){g[d]=g[d]||{};var e=g[d][a.uuid]=
g[d][a.uuid]||{geo:a.geo||[0,0],uuid:a.uuid,last:+new Date,socket:f,namespace:d,connected:!1,slot:f.user_count++};e.last=+new Date;e.data=c.cuser;e.connected||(b.events.fire(d+"join",e),e.connected=!0)})}});k&&(setInterval(e,3E4),e());return f}}})();
